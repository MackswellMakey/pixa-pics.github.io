(window.webpackJsonp=window.webpackJsonp||[]).push([["main~c1dd23ef"],{170:function(e,t,n){"use strict";var a=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable;e.exports=function(){var e,t,n,r;try{if(!Object.assign)return;if((e=new String("abc"))[5]="de","5"===Object.getOwnPropertyNames(e)[0])return;for(t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;return"0123456789"===Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join("")&&(r={},"abcdefghijklmnopqrst".split("").forEach(function(e){r[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join(""))}catch(e){return}}()?Object.assign:function(e,t){for(var n,r,o,i,s=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),c=1;c<arguments.length;c++){for(o in n=Object(arguments[c]))u.call(n,o)&&(s[o]=n[o]);if(a)for(r=a(n),i=0;i<r.length;i++)f.call(n,r[i])&&(s[r[i]]=n[r[i]])}return s}},307:function(e,H,t){"use strict";!function(e){function o(e){return e&&"[object Function]"==={}.toString.call(e)}function l(e,t){return 1!==e.nodeType?[]:(e=e.ownerDocument.defaultView.getComputedStyle(e,null),t?e[t]:e)}function u(e){return"HTML"===e.nodeName?e:e.parentNode||e.host}function f(e){if(!e)return document.body;switch(e.nodeName){case"HTML":case"BODY":return e.ownerDocument.body;case"#document":return e.body}var t=l(e);return/(auto|scroll|overlay)/.test(t.overflow+t.overflowY+t.overflowX)?e:f(u(e))}function d(e){return e&&e.referenceNode?e.referenceNode:e}function p(e){return 11===e?N:10!==e&&N||R}function v(e){var t,n,r;if(!e)return document.documentElement;for(t=p(10)?document.body:null,n=e.offsetParent||null;n===t&&e.nextElementSibling;)n=(e=e.nextElementSibling).offsetParent;return(r=n&&n.nodeName)&&"BODY"!==r&&"HTML"!==r?-1!==["TH","TD","TABLE"].indexOf(n.nodeName)&&"static"===l(n,"position")?v(n):n:(e?e.ownerDocument:document).documentElement}function i(e){return null!==e.parentNode?i(e.parentNode):e}function h(e,t){var n,r,o;return e&&e.nodeType&&t&&t.nodeType?(r=(n=e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_FOLLOWING)?e:t,o=n?t:e,(n=document.createRange()).setStart(r,0),n.setEnd(o,0),e!==(n=n.commonAncestorContainer)&&t!==n||r.contains(o)?"BODY"===(o=(r=n).nodeName)||"HTML"!==o&&v(r.firstElementChild)!==r?v(n):n:(n=i(e)).host?h(n.host,t):h(e,i(t).host)):document.documentElement}function m(e,t){var n=e.nodeName;return("BODY"===n||"HTML"===n?e.ownerDocument.scrollingElement||e.ownerDocument.documentElement:e)["top"===(1<arguments.length&&void 0!==t?t:"top")?"scrollTop":"scrollLeft"]}function s(e,t){var n="x"===t?"Left":"Top",t="Left"==n?"Right":"Bottom";return parseFloat(e["border"+n+"Width"])+parseFloat(e["border"+t+"Width"])}function r(e,t,n,r){return Math.max(t["offset"+e],t["scroll"+e],n["client"+e],n["offset"+e],n["scroll"+e],p(10)?parseInt(n["offset"+e])+parseInt(r["margin"+("Height"===e?"Top":"Left")])+parseInt(r["margin"+("Height"===e?"Bottom":"Right")]):0)}function g(e){var t=e.body,n=e.documentElement,e=p(10)&&getComputedStyle(n);return{height:r("Height",t,n,e),width:r("Width",t,n,e)}}function _(e){return M({},e,{right:e.left+e.width,bottom:e.top+e.height})}function y(e){var t,n,r={};try{p(10)?(r=e.getBoundingClientRect(),t=m(e,"top"),n=m(e,"left"),r.top+=t,r.left+=n,r.bottom+=t,r.right+=n):r=e.getBoundingClientRect()}catch(e){}return t={left:r.left,top:r.top,width:r.right-r.left,height:r.bottom-r.top},n="HTML"===e.nodeName?g(e.ownerDocument):{},r=e.offsetHeight-(n.height||e.clientHeight||t.height),((n=e.offsetWidth-(n.width||e.clientWidth||t.width))||r)&&(n-=s(e=l(e),"x"),r-=s(e,"y"),t.width-=n,t.height-=r),_(t)}function b(e,t,n){var r=2<arguments.length&&void 0!==n&&n,o=p(10),i="HTML"===t.nodeName,s=y(e),c=y(t),a=f(e),u=l(t),n=parseFloat(u.borderTopWidth),e=parseFloat(u.borderLeftWidth);return r&&i&&(c.top=Math.max(c.top,0),c.left=Math.max(c.left,0)),(s=_({top:s.top-c.top-n,left:s.left-c.left-e,width:s.width,height:s.height})).marginTop=0,s.marginLeft=0,!o&&i&&(i=parseFloat(u.marginTop),u=parseFloat(u.marginLeft),s.top-=n-i,s.bottom-=n-i,s.left-=e-u,s.right-=e-u,s.marginTop=i,s.marginLeft=u),(o&&!r?t.contains(a):t===a&&"BODY"!==a.nodeName)?function(e,t){var n=2<arguments.length&&!1,r=m(t,"top"),t=m(t,"left"),n=n?-1:1;return e.top+=r*n,e.bottom+=r*n,e.left+=t*n,e.right+=t*n,e}(s,t):s}function w(e){if(!e||!e.parentElement||p())return document.documentElement;for(var t=e.parentElement;t&&"none"===l(t,"transform");)t=t.parentElement;return t||document.documentElement}function k(e,t,n,r,o){var i,s=4<arguments.length&&void 0!==o&&o,c={top:0,left:0},a=s?w(e):h(e,d(t));return"viewport"===r?c=function(e,t){var n=1<arguments.length&&void 0!==t&&t,r=e.ownerDocument.documentElement,o=b(e,r),i=Math.max(r.clientWidth,window.innerWidth||0),t=Math.max(r.clientHeight,window.innerHeight||0),e=n?0:m(r),r=n?0:m(r,"left");return _({top:e-o.top+o.marginTop,left:r-o.left+o.marginLeft,width:i,height:t})}(a,s):(o=void 0,"scrollParent"===r?"BODY"===(o=f(u(t))).nodeName&&(o=e.ownerDocument.documentElement):o="window"===r?e.ownerDocument.documentElement:r,i=b(o,a,s),"HTML"!==o.nodeName||function e(t){var n=t.nodeName;return"BODY"!==n&&"HTML"!==n&&("fixed"===l(t,"position")||!!(t=u(t))&&e(t))}(a)?c=i:(e=(a=g(e.ownerDocument)).height,a=a.width,c.top+=i.top-i.marginTop,c.bottom=e+i.top,c.left+=i.left-i.marginLeft,c.right=a+i.left)),c.left+=(i="number"==typeof(n=n||0))?n:n.left||0,c.top+=i?n:n.top||0,c.right-=i?n:n.right||0,c.bottom-=i?n:n.bottom||0,c}function c(e,t,n,r,o,i){var s,i=5<arguments.length&&void 0!==i?i:0;return-1===e.indexOf("auto")?e:(o=k(n,r,i,o),s={top:{width:o.width,height:t.top-o.top},right:{width:o.right-t.right,height:o.height},bottom:{width:o.width,height:o.bottom-t.bottom},left:{width:t.left-o.left,height:o.height}},(0<(o=(t=Object.keys(s).map(function(e){return M({key:e},s[e],{area:(e=s[e]).width*e.height})}).sort(function(e,t){return t.area-e.area})).filter(function(e){return n.clientWidth<=e.width&&n.clientHeight<=e.height})).length?o:t)[0].key+((e=e.split("-")[1])?"-"+e:""))}function a(e,t,n,r){r=3<arguments.length&&void 0!==r?r:null;return b(n,r?w(t):h(t,d(n)),r)}function O(e){var t=e.ownerDocument.defaultView.getComputedStyle(e),n=parseFloat(t.marginTop||0)+parseFloat(t.marginBottom||0),t=parseFloat(t.marginLeft||0)+parseFloat(t.marginRight||0);return{width:e.offsetWidth+t,height:e.offsetHeight+n}}function j(e){var t={left:"right",right:"left",bottom:"top",top:"bottom"};return e.replace(/left|right|bottom|top/g,function(e){return t[e]})}function x(e,t,n){var r,o,i,s,c;return n=n.split("-")[0],o={width:(r=O(e)).width,height:r.height},i=(s=-1!==["right","left"].indexOf(n))?"left":"top",c=s?"width":"height",o[e=s?"top":"left"]=t[e]+t[s=s?"height":"width"]/2-r[s]/2,o[i]=n===i?t[i]-r[c]:t[j(i)],o}function E(e,t){return Array.prototype.find?e.find(t):e.filter(t)[0]}function q(e,n,t){return(void 0===t?e:e.slice(0,function(e,t){if(Array.prototype.findIndex)return e.findIndex(function(e){return e.name===t});var n=E(e,function(e){return e.name===t});return e.indexOf(n)}(e,t))).forEach(function(e){var t=e.function||e.fn;e.enabled&&o(t)&&(n.offsets.popper=_(n.offsets.popper),n.offsets.reference=_(n.offsets.reference),n=t(n,e))}),n}function t(e,t){return e.some(function(e){return e.enabled&&e.name===t})}function S(e){for(var t,n=[!1,"ms","Webkit","Moz","O"],r=e.charAt(0).toUpperCase()+e.slice(1),o=0;o<n.length;o++)if(t=(t=n[o])?""+t+r:e,void 0!==document.body.style[t])return t;return null}function A(e){e=e.ownerDocument;return e?e.defaultView:window}function P(e){return""!==e&&!isNaN(parseFloat(e))&&isFinite(e)}function D(n,r){Object.keys(r).forEach(function(e){var t="";-1!==["width","height","top","right","bottom","left"].indexOf(e)&&P(r[e])&&(t="px"),n.style[e]=r[e]+t})}function C(e,t,n){var r=E(e,function(e){return e.name===t});return r&&e.some(function(e){return e.name===n&&e.enabled&&e.order<r.order})}function n(e,t){t=1<arguments.length&&void 0!==t&&t,e=J.indexOf(e),e=J.slice(e+1).concat(J.slice(0,e));return t?e.reverse():e}function $(e,t){var n=this,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};(function(e){if(!(e instanceof $))throw new TypeError("Cannot call a class as a function")})(this),this.scheduleUpdate=function(){return requestAnimationFrame(n.update)},this.update=T(this.update.bind(this)),this.options=M({},$.Defaults,r),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=e&&e.jquery?e[0]:e,this.popper=t&&t.jquery?t[0]:t,this.options.modifiers={},Object.keys(M({},$.Defaults.modifiers,r.modifiers)).forEach(function(e){n.options.modifiers[e]=M({},$.Defaults.modifiers[e]||{},r.modifiers?r.modifiers[e]:{})}),this.modifiers=Object.keys(this.options.modifiers).map(function(e){return M({name:e},n.options.modifiers[e])}).sort(function(e,t){return e.order-t.order}),this.modifiers.forEach(function(e){e.enabled&&o(e.onLoad)&&e.onLoad(n.reference,n.popper,n.options,e,n.state)}),this.update(),(t=this.options.eventsEnabled)&&this.enableEventListeners(),this.state.eventsEnabled=t}function L(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var B="undefined"!=typeof window&&"undefined"!=typeof document&&"undefined"!=typeof navigator,I=function(){for(var e=["Edge","Trident","Firefox"],t=0;t<e.length;t+=1)if(B&&0<=navigator.userAgent.indexOf(e[t]))return 1;return 0}(),T=B&&window.Promise?function(e){var t=!1;return function(){t||(t=!0,window.Promise.resolve().then(function(){t=!1,e()}))}}:function(e){var t=!1;return function(){t||(t=!0,setTimeout(function(){t=!1,e()},I))}},N=B&&!(!window.MSInputMethodContext||!document.documentMode),R=B&&/MSIE 10/.test(navigator.userAgent),M=Object.assign||function(e){for(var t,n,r=1;r<arguments.length;r++)for(n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},F=B&&/Firefox/i.test(navigator.userAgent),z=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],J=z.slice(3),K={placement:"bottom",positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:{shift:{order:100,enabled:!0,fn:function(e){var t,n,r=e.placement,o=r.split("-")[0],i=r.split("-")[1];return i&&(t=(n=e.offsets).reference,r=n.popper,o=(n=-1!==["bottom","top"].indexOf(o))?"width":"height",o={start:L({},n=n?"left":"top",t[n]),end:L({},n,t[n]+t[o]-r[o])},e.offsets.popper=M({},r,o[i])),e}},offset:{order:200,enabled:!0,fn:function(e,t){var c,a,o,r,n=t.offset,i=e.placement,s=e.offsets,t=s.popper,s=s.reference,i=i.split("-")[0],u=P(+n)?[+n,0]:(n=n,c=t,a=s,o=[0,0],r=-1!==["right","left"].indexOf(i),s=(u=n.split(/(\+|\-)/).map(function(e){return e.trim()})).indexOf(E(u,function(e){return-1!==e.search(/,|\s/)})),u[s]&&u[s].indexOf(","),n=/\s*,\s*|\s+/,(-1!==s?[u.slice(0,s).concat([u[s].split(n)[0]]),[u[s].split(n)[1]].concat(u.slice(s+1))]:[u]).map(function(e,t){var s=(1===t?!r:r)?"height":"width",n=!1;return e.reduce(function(e,t){return""===e[e.length-1]&&-1!==["+","-"].indexOf(t)?(e[e.length-1]=t,n=!0,e):n?(e[e.length-1]+=t,n=!1,e):e.concat(t)},[]).map(function(e){return n=s,r=c,o=a,e=(i=(t=e).match(/((?:\-|\+)?\d*\.?\d*)(.*)/))[2],(i=+i[1])?0===e.indexOf("%")?_("%p"===e?r:o)[n]/100*i:"vh"===e||"vw"===e?("vh"===e?Math.max(document.documentElement.clientHeight,window.innerHeight||0):Math.max(document.documentElement.clientWidth,window.innerWidth||0))/100*i:i:t;var t,n,r,o,i})}).forEach(function(n,r){n.forEach(function(e,t){P(e)&&(o[r]+=e*("-"===n[t-1]?-1:1))})}),o);return"left"===i?(t.top+=u[0],t.left-=u[1]):"right"===i?(t.top+=u[0],t.left+=u[1]):"top"===i?(t.left+=u[0],t.top-=u[1]):"bottom"===i&&(t.left+=u[0],t.top+=u[1]),e.popper=t,e},offset:0},preventOverflow:{order:300,enabled:!0,fn:function(e,r){var t,n,o,i,s,c,a,u,f=r.boundariesElement||v(e.instance.popper);return e.instance.reference===f&&(f=v(f)),t=S("transform"),o=(n=e.instance.popper.style).top,i=n.left,s=n[t],n.top="",n.left="",n[t]="",c=k(e.instance.popper,e.instance.reference,r.padding,f,e.positionFixed),n.top=o,n.left=i,n[t]=s,r.boundaries=c,a=e.offsets.popper,u={primary:function(e){var t=a[e];return L({},e,t=a[e]<c[e]&&!r.escapeWithReference?Math.max(a[e],c[e]):t)},secondary:function(e){var t="right"===e?"left":"top",n=a[t];return L({},t,n=c[e]<a[e]&&!r.escapeWithReference?Math.min(a[t],c[e]-("right"===e?a.width:a.height)):n)}},r.priority.forEach(function(e){var t=-1!==["left","top"].indexOf(e)?"primary":"secondary";a=M({},a,u[t](e))}),e.offsets.popper=a,e},priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:function(e){var t=e.offsets,n=t.popper,r=t.reference,o=e.placement.split("-")[0],i=Math.floor,s=-1!==["top","bottom"].indexOf(o),t=s?"right":"bottom",o=s?"left":"top",s=s?"width":"height";return n[t]<i(r[o])&&(e.offsets.popper[o]=i(r[o])-n[s]),n[o]>i(r[t])&&(e.offsets.popper[o]=i(r[t])),e}},arrow:{order:500,enabled:!0,fn:function(e,t){var n,r,o,i,s,c,a,u,f;if(!C(e.instance.modifiers,"arrow","keepTogether"))return e;if("string"==typeof(n=t.element)){if(!(n=e.instance.popper.querySelector(n)))return e}else if(!e.instance.popper.contains(n))return e;return s=e.placement.split("-")[0],r=(a=e.offsets).popper,u=a.reference,o=(c=-1!==["left","right"].indexOf(s))?"height":"width",i=(f=c?"Top":"Left").toLowerCase(),t=c?"left":"top",a=c?"bottom":"right",s=O(n)[o],u[a]-s<r[i]&&(e.offsets.popper[i]-=r[i]-(u[a]-s)),r[a]<u[i]+s&&(e.offsets.popper[i]+=u[i]+s-r[a]),e.offsets.popper=_(e.offsets.popper),c=u[i]+u[o]/2-s/2,a=l(e.instance.popper),u=parseFloat(a["margin"+f]),f=parseFloat(a["border"+f+"Width"]),f=Math.max(Math.min(r[o]-s,c-e.offsets.popper[i]-u-f),0),e.arrowElement=n,e.offsets.arrow=(L(n={},i,Math.round(f)),L(n,t,""),n),e},element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:function(a,u){var f,l,d,p,h;if(t(a.instance.modifiers,"inner"))return a;if(a.flipped&&a.placement===a.originalPlacement)return a;switch(f=k(a.instance.popper,a.instance.reference,u.padding,u.boundariesElement,a.positionFixed),l=a.placement.split("-")[0],d=j(l),p=a.placement.split("-")[1]||"",h=[],u.behavior){case"flip":h=[l,d];break;case"clockwise":h=n(l);break;case"counterclockwise":h=n(l,!0);break;default:h=u.behavior}return h.forEach(function(e,t){var n,r,o,i,s,c;return l!==e||h.length===t+1?a:(l=a.placement.split("-")[0],d=j(l),s=a.offsets.popper,i=a.offsets.reference,c=Math.floor,n="left"===l&&c(s.right)>c(i.left)||"right"===l&&c(s.left)<c(i.right)||"top"===l&&c(s.bottom)>c(i.top)||"bottom"===l&&c(s.top)<c(i.bottom),r=c(s.left)<c(f.left),o=c(s.right)>c(f.right),e=c(s.top)<c(f.top),i=c(s.bottom)>c(f.bottom),s="left"===l&&r||"right"===l&&o||"top"===l&&e||"bottom"===l&&i,c=-1!==["top","bottom"].indexOf(l),e=!!u.flipVariations&&(c&&"start"===p&&r||c&&"end"===p&&o||!c&&"start"===p&&e||!c&&"end"===p&&i)||!!u.flipVariationsByContent&&(c&&"start"===p&&o||c&&"end"===p&&r||!c&&"start"===p&&i||!c&&"end"===p&&e),void((n||s||e)&&(a.flipped=!0,(n||s)&&(l=h[t+1]),e&&(p="end"===p?"start":"start"===p?"end":p),a.placement=l+(p?"-"+p:""),a.offsets.popper=M({},a.offsets.popper,x(a.instance.popper,a.offsets.reference,a.placement)),a=q(a.instance.modifiers,a,"flip"))))}),a},behavior:"flip",padding:5,boundariesElement:"viewport",flipVariations:!1,flipVariationsByContent:!1},inner:{order:700,enabled:!1,fn:function(e){var t=e.placement,n=t.split("-")[0],r=e.offsets,o=r.popper,i=r.reference,s=-1!==["left","right"].indexOf(n),r=-1===["top","left"].indexOf(n);return o[s?"left":"top"]=i[n]-(r?o[s?"width":"height"]:0),e.placement=j(t),e.offsets.popper=_(o),e}},hide:{order:800,enabled:!0,fn:function(e){var t,n;if(!C(e.instance.modifiers,"hide","preventOverflow"))return e;if(t=e.offsets.reference,n=E(e.instance.modifiers,function(e){return"preventOverflow"===e.name}).boundaries,t.bottom<n.top||n.right<t.left||n.bottom<t.top||t.right<n.left){if(!0===e.hide)return e;e.hide=!0,e.attributes["x-out-of-boundaries"]=""}else{if(!1===e.hide)return e;e.hide=!1,e.attributes["x-out-of-boundaries"]=!1}return e}},computeStyle:{order:850,enabled:!0,fn:function(e,t){var n=t.x,r=t.y,o=e.offsets.popper,i=E(e.instance.modifiers,function(e){return"applyStyle"===e.name}).gpuAcceleration,s=void 0!==i?i:t.gpuAcceleration,c=v(e.instance.popper),a=y(c),u={position:o.position},f=e,l=window.devicePixelRatio<2||!F,d=(g=f.offsets).popper,p=Math.round,h=Math.floor,m=function(e){return e},i=p(g.reference.width),t=p(d.width),o=-1!==["left","right"].indexOf(f.placement),g=-1!==f.placement.indexOf("-"),f=l?p:m,f={left:(m=l?o||g||i%2==t%2?p:h:m)(i%2==1&&t%2==1&&!g&&l?d.left-1:d.left),top:f(d.top),bottom:f(d.bottom),right:m(d.right)},m="bottom"===n?"top":"bottom",d="right"===r?"left":"right",n=S("transform"),r="bottom"==m?"HTML"===c.nodeName?-c.clientHeight+f.bottom:-a.height+f.bottom:f.top,f="right"==d?"HTML"===c.nodeName?-c.clientWidth+f.right:-a.width+f.right:f.left;return s&&n?(u[n]="translate3d("+f+"px, "+r+"px, 0)",u[m]=0,u[d]=0,u.willChange="transform"):(n="right"==d?-1:1,u[m]=r*("bottom"==m?-1:1),u[d]=f*n,u.willChange=m+", "+d),e.attributes=M({},{"x-placement":e.placement},e.attributes),e.styles=M({},u,e.styles),e.arrowStyles=M({},e.offsets.arrow,e.arrowStyles),e},gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:function(e){var t,n;return D(e.instance.popper,e.styles),t=e.instance.popper,n=e.attributes,Object.keys(n).forEach(function(e){!1!==n[e]?t.setAttribute(e,n[e]):t.removeAttribute(e)}),e.arrowElement&&Object.keys(e.arrowStyles).length&&D(e.arrowElement,e.arrowStyles),e},onLoad:function(e,t,n,r,o){o=a(o,t,e,n.positionFixed),e=c(n.placement,o,t,e,n.modifiers.flip.boundariesElement,n.modifiers.flip.padding);return t.setAttribute("x-placement",e),D(t,{position:n.positionFixed?"fixed":"absolute"}),n},gpuAcceleration:void 0}}},U=(function(e,t){for(var n,r=0;r<t.length;r++)(n=t[r]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}($.prototype,[{key:"update",value:function(){return function(){var e;this.state.isDestroyed||((e={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}}).offsets.reference=a(this.state,this.popper,this.reference,this.options.positionFixed),e.placement=c(this.options.placement,e.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),e.originalPlacement=e.placement,e.positionFixed=this.options.positionFixed,e.offsets.popper=x(this.popper,e.offsets.reference,e.placement),e.offsets.popper.position=this.options.positionFixed?"fixed":"absolute",e=q(this.modifiers,e),this.state.isCreated?this.options.onUpdate(e):(this.state.isCreated=!0,this.options.onCreate(e)))}.call(this)}},{key:"destroy",value:function(){return function(){return this.state.isDestroyed=!0,t(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.position="",this.popper.style.top="",this.popper.style.left="",this.popper.style.right="",this.popper.style.bottom="",this.popper.style.willChange="",this.popper.style[S("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}.call(this)}},{key:"enableEventListeners",value:function(){return function(){this.state.eventsEnabled||(this.state=function(e,t,n){t.updateBound=n,A(e).addEventListener("resize",t.updateBound,{passive:!0});e=f(e);return function e(t,n,r,o){var i="BODY"===t.nodeName,t=i?t.ownerDocument.defaultView:t;t.addEventListener(n,r,{passive:!0}),i||e(f(t.parentNode),n,r,o),o.push(t)}(e,"scroll",t.updateBound,t.scrollParents),t.scrollElement=e,t.eventsEnabled=!0,t}(this.reference,this.state,this.scheduleUpdate))}.call(this)}},{key:"disableEventListeners",value:function(){return function(){var t;this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=(t=this.state,A(this.reference).removeEventListener("resize",t.updateBound),t.scrollParents.forEach(function(e){e.removeEventListener("scroll",t.updateBound)}),t.updateBound=null,t.scrollParents=[],t.scrollElement=null,t.eventsEnabled=!1,t))}.call(this)}}]),$);U.Utils=("undefined"!=typeof window?window:e).PopperUtils,U.placements=z,U.Defaults=K,H.a=U}.call(this,t(77))},431:function(e,cr,ar){"use strict";ar.r(cr),function(l){function i(e){return e.substring(1)}function r(){this._store={}}function e(e){if(this._store=new r,e&&Array.isArray(e))for(var t=0,n=e.length;t<n;t++)this.add(e[t])}function N(e){var t,n,r,o,i,s,c,a,u;if(!e||"object"!=typeof e)return e;if(Array.isArray(e)){for(t=[],n=0,r=e.length;n<r;n++)t[n]=N(e[n]);return t}if(e instanceof Date&&isFinite(e))return e.toISOString();if("undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer||"undefined"!=typeof Blob&&e instanceof Blob)return(i=e)instanceof ArrayBuffer?"function"==typeof(u=i).slice?u.slice(0):(c=new ArrayBuffer(u.byteLength),a=new Uint8Array(c),u=new Uint8Array(u),a.set(u),c):(c=i.size,s=i.type,"function"==typeof i.slice?i.slice(0,c,s):i.webkitSlice(0,c,s));if(!(null===(s=Object.getPrototypeOf(e))||"function"==typeof(s=s.constructor)&&s instanceof s&&Rt.call(s)==Mt))return e;for(n in t={},e)Object.prototype.hasOwnProperty.call(e,n)&&void 0!==(o=N(e[n]))&&(t[n]=o);return t}function c(t){var n=!1;return or()(function(e){if(n)throw new Error("once called more than once");n=!0,t.apply(this,e)})}function s(s){return or()(function(o){var i,t,e;return o=N(o),i=this,t="function"==typeof o[o.length-1]&&o.pop(),e=new Promise(function(n,r){var e,t;try{t=c(function(e,t){e?r(e):n(t)}),o.push(t),(e=s.apply(i,o))&&"function"==typeof e.then&&n(e)}catch(e){r(e)}}),t&&e.then(function(e){t(null,e)},t),e})}function d(i,e){return s(or()(function(r){if(this._closed)return Promise.reject(new Error("database is closed"));if(this._destroyed)return Promise.reject(new Error("database is destroyed"));var o=this;return function(r,o,e){var t,n,i;if(r.constructor.listeners("debug").length){for(t=["api",r.name,o],n=0;n<e.length-1;n++)t.push(e[n]);r.constructor.emit("debug",t),i=e[e.length-1],e[e.length-1]=function(e,t){var n=(n=["api",r.name,o]).concat(e?["error",e]:["success",t]);r.constructor.emit("debug",n),i(e,t)}}}(o,i,r),this.taskqueue.isReady?e.apply(this,r):new Promise(function(t,n){o.taskqueue.addTask(function(e){e?n(e):t(o[i].apply(o,r))})})}))}function h(e,t){for(var n,r={},o=0,i=t.length;o<i;o++)(n=t[o])in e&&(r[n]=e[n]);return r}function m(e){return e}function g(e){return[{ok:e}]}function p(c,a,u){var f,l,d,r,t,e=a.docs,p=new Nt;e.forEach(function(e){p.has(e.id)?p.get(e.id).push(e):p.set(e.id,[e])}),f=p.size,l=0,d=new Array(f),r=[],p.forEach(function(e,t){r.push(t)}),t=0,function s(){var n,e;r.length<=t||(e=Math.min(t+6,r.length),e=r.slice(t,e),n=t,e.forEach(function(r,e){var o,i=n+e,e=p.get(r),t=h(e[0],["atts_since","attachments"]);t.open_revs=e.map(function(e){return e.rev}),t.open_revs=t.open_revs.filter(m),o=m,0===t.open_revs.length&&(delete t.open_revs,o=g),["revs","attachments","binary","ajax","latest"].forEach(function(e){e in a&&(t[e]=a[e])}),c.get(r,t,function(e,t){var n,t=e?[{error:e}]:o(t);d[i]={id:r,docs:t},++l===f&&(n=[],d.forEach(function(t){t.docs.forEach(function(e){n.push({id:t.id,docs:[e]})})}),u(null,{results:n})),s()})}),t+=e.length)}()}function t(){var t;sr.a.call(this),this._listeners={},t=this,Ft&&addEventListener("storage",function(e){t.emit(e.key)})}function v(e){"undefined"!=typeof console&&"function"==typeof console[e]&&Array.prototype.slice.call(arguments,1)}function R(e){var e=(t=e)?0:2e3,t=parseInt(t,10)||0;return(e=parseInt(e,10))!=e||e<=t?e=(t||1)<<1:e+=1,6e5<e&&(t=3e5,e=6e5),~~((e-t)*Math.random()+t)}function y(e,t){v("info","The above "+e+" is totally normal. "+t)}function n(e,t,n){Error.call(this,n),this.status=e,this.name=t,this.message=n,this.error=!0}function M(o,e){function t(e){for(var t=Object.getOwnPropertyNames(o),n=0,r=t.length;n<r;n++)"function"!=typeof o[t[n]]&&(this[t[n]]=o[t[n]]);void 0===this.stack&&(this.stack=(new Error).stack),void 0!==e&&(this.reason=e)}return t.prototype=n.prototype,new t(e)}function w(e){var t;return"object"!=typeof e&&(t=e,(e=Gt).data=t),"error"in e&&"conflict"===e.error&&(e.name="conflict",e.status=409),"name"in e||(e.name=e.error||"unknown"),"status"in e||(e.status=500),"message"in e||(e.message=e.message||e.reason),"stack"in e||(e.stack=(new Error).stack),e}function F(r){var o={},i=r.filter&&"function"==typeof r.filter;return o.query=r.query_params,function(e){var t,n;if(e.doc||(e.doc={}),"object"==typeof(t=i&&function(e,t,n){try{return!e(t,n)}catch(e){n="Filter function threw: "+e.toString();return M(Zt,n)}}(r.filter,e.doc,o)))return t;if(t)return!1;if(r.include_docs){if(!r.attachments)for(n in e.doc._attachments)Object.prototype.hasOwnProperty.call(e.doc._attachments,n)&&(e.doc._attachments[n].stub=!0)}else delete e.doc;return!0}}function z(e){for(var t=[],n=0,r=e.length;n<r;n++)t=t.concat(e[n]);return t}function _(e){var t;if(e?"string"!=typeof e?t=M(Ht):/^_/.test(e)&&!/^_(design|local)/.test(e)&&(t=M(Vt)):t=M(Wt),t)throw t}function J(e){return"boolean"==typeof e._remote?e._remote:"function"==typeof e.type&&(v("warn","db.type() is deprecated and will be removed in a future version of PouchDB"),"http"===e.type())}function a(e){if(!e)return null;var t=e.split("/");return 2===t.length?t:1===t.length?[e,e]:null}function o(e){e=a(e);return e?e.join("/"):null}function b(e){for(var t,n,r,o=an.exec(e),i={},s=14;s--;)t=on[s],n=o[s]||"",r=-1!==["user","password"].indexOf(t),i[t]=r?decodeURIComponent(n):n;return i[sn]={},i[on[12]].replace(cn,function(e,t,n){t&&(i[sn][t]=n)}),i}function u(e,t){var n,r=[],o=[];for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r.push(n),o.push(t[n]));return r.push(e),Function.apply(null,r).apply(null,o)}function f(i,s,c){return i.get(s).catch(function(e){if(404!==e.status)throw e;return{}}).then(function(e){var t,n,r,o=e._rev,e=c(e);return e?(e._id=s,e._rev=o,r=c,(t=i).put(n=e).then(function(e){return{updated:!0,rev:e.rev}},function(e){if(409!==e.status)throw e;return f(t,n._id,r)})):{updated:!1,rev:o}})}function k(t,n){var r,o;t=t||[],n=n||{};try{return new Blob(t,n)}catch(e){if("TypeError"!==e.name)throw e;for(r=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),o=0;o<t.length;o+=1)r.append(t[o]);return r.getBlob(n.type)}}function O(e,t){return k([function(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),o=0;o<t;o++)r[o]=e.charCodeAt(o);return n}(e)],{type:t})}function j(e,t){return O(un(e),t)}function x(e,t){var n=new FileReader,r="function"==typeof n.readAsBinaryString;n.onloadend=function(e){var o=e.target.result||"";if(r)return t(o);t(function(){for(var e="",t=new Uint8Array(o),n=t.byteLength,r=0;r<n;r++)e+=String.fromCharCode(t[r]);return e}())},r?n.readAsBinaryString(e):n.readAsArrayBuffer(e)}function E(e,t){x(e,function(e){t(e)})}function q(e,t){E(e,function(e){t(fn(e))})}function S(buffer,e,t,n,r){var o,i;(0<t||n<e.size)&&(t=t,o=n,e=(n=e).webkitSlice?n.webkitSlice(t,o):n.slice(t,o)),o=e,i=function(e){buffer.append(e),r()},(e=new FileReader).onloadend=function(e){e=e.target.result||new ArrayBuffer(0);i(e)},e.readAsArrayBuffer(o)}function A(buffer,e,t,n,r){(0<t||n<e.length)&&(e=e.substring(t,n)),buffer.appendBinary(e),r()}function K(t,n){function r(){ln(e)}function o(){var e=buffer.end(!0),e=fn(e);n(e),buffer.destroy()}function e(){var e=u*c;f(buffer,t,e,e+c,++u<a?r:o)}var i="string"==typeof t,s=i?t.length:t.size,c=Math.min(32768,s),a=Math.ceil(s/c),u=0,buffer=new(i?nr.a:nr.a.ArrayBuffer),f=i?A:S;e()}function P(e){return nr.a.hash(e)}function D(e,t){if(!t)return Object(tr.a)().replace(/-/g,"").toLowerCase();e=zt({},e);return delete e._rev_tree,P(JSON.stringify(e))}function L(e){for(var t,n,r,o,i,s,c,a,u,f=e.rev_tree.slice();a=f.pop();)if(i=a.pos,(o=(u=a.ids)[2]).length)for(s=0,c=o.length;s<c;s++)f.push({pos:i+1,ids:o[s]});else a=!!u[1].deleted,u=u[0],t&&!(r!==a?r:n!==i?n<i:t<u)||(t=u,n=i,r=a);return n+"-"+t}function B(e,t){for(var n,r,o,i,s,c,a,u=e.slice();n=u.pop();)for(s=t(0===(i=(o=n.ids)[2]).length,r=n.pos,o[0],n.ctx,o[1]),c=0,a=i.length;c<a;c++)u.push({pos:r+1,ids:i[c],ctx:s})}function C(e,t){return e.pos-t.pos}function $(e){var t,n,i=[];for(B(e,function(e,t,n,r,o){e&&i.push({rev:t+"-"+n,pos:t,opts:o})}),i.sort(C).reverse(),t=0,n=i.length;t<n;t++)delete i[t].pos;return i}function I(e){for(var t,n=L(e),r=$(e.rev_tree),o=[],i=0,s=r.length;i<s;i++)(t=r[i]).rev===n||t.opts.deleted||o.push(t.rev);return o}function T(e){for(var t,n,r,o,i,s,c,a,u,f=[],l=e.slice();t=l.pop();)for(n=t.pos,r=(s=t.ids)[0],o=s[1],s=0===(i=s[2]).length,(c=t.history?t.history.slice():[]).push({id:r,opts:o}),s&&f.push({pos:n+1-c.length,ids:c}),a=0,u=i.length;a<u;a++)l.push({pos:n+1,ids:i[a],history:c});return f.reverse()}function U(e,t){return e.pos-t.pos}function H(e,t){for(var n,r,o,i=t,s=e.length;i<s;i++)o=[(o=e[i]).id,o.opts,[]],r?(r[2].push(o),r=o):n=r=o;return n}function W(e,t){return e[0]<t[0]?-1:1}function V(e,t){for(var n,r,o,i,s,c,a,u,f,l=[{tree1:e,tree2:t}],d=!1;0<l.length;)for(o=(n=l.pop()).tree2,((r=n.tree1)[1].status||o[1].status)&&(r[1].status="available"===r[1].status||"available"===o[1].status?"available":"missing"),i=0;i<o[2].length;i++)if(r[2][0]){for(s=!1,c=0;c<r[2].length;c++)r[2][c][0]===o[2][i][0]&&(l.push({tree1:r[2][c],tree2:o[2][i]}),s=!0);s||(d="new_branch",f=function(e,t,n){for(var r,o=0,i=e.length;o<i;)n(e[r=o+i>>>1],t)<0?o=1+r:i=r;return o}(a=r[2],u=o[2][i],W),a.splice(f,0,u))}else d="new_leaf",r[2][0]=o[2][i];return{conflicts:d,tree:e}}function G(e,t,n){var r,o,i,s,c,a,u,f,l,d,p,h,m,g=[],v=!1,_=!1;if(!e.length)return{tree:[t],conflicts:"new_leaf"};for(o=0,i=e.length;o<i;o++)if((s=e[o]).pos===t.pos&&s.ids[0]===t.ids[0])r=V(s.ids,t.ids),g.push({pos:s.pos,ids:r.tree}),v=v||r.conflicts,_=!0;else if(!0!==n){for(u=[],(f=[]).push({ids:(c=s.pos<t.pos?s:t).ids,diff:(a=s.pos<t.pos?t:s).pos-c.pos,parent:null,parentIdx:null});0<f.length;)if(0!==(l=f.pop()).diff)for(p=0,h=(d=l.ids[2]).length;p<h;p++)f.push({ids:d[p],diff:l.diff-1,parent:l.ids,parentIdx:p});else l.ids[0]===a.ids[0]&&u.push(l);(m=u[0])?(r=V(m.ids,a.ids),m.parent[2][m.parentIdx]=r.tree,g.push({pos:c.pos,ids:c.ids}),v=v||r.conflicts,_=!0):g.push(s)}else g.push(s);return _||g.push(t),g.sort(U),{tree:g,conflicts:v||"internal_node"}}function Y(e,t,n){var l=G(e,t),n=function(e){for(var r,t,n,o,i,s,c,a=T(l.tree),u=0,f=a.length;u<f;u++){if(e<(o=(n=a[u]).ids).length)for(r=r||{},i={pos:n.pos+(s=o.length-e),ids:H(o,s)},c=0;c<s;c++)r[n.pos+c+"-"+o[c].id]=!0;else i={pos:n.pos,ids:H(o,0)};t=t?G(t,i,!0).tree:[i]}return r&&B(t,function(e,t,n){delete r[t+"-"+n]}),{tree:t,revs:r?Object.keys(r):[]}}(n);return{tree:n.tree,stemmedRevs:n.revs,conflicts:l.conflicts}}function Q(e){return e.ids}function X(e,t){for(var n,r=(t=t||L(e)).substring(t.indexOf("-")+1),o=e.rev_tree.map(Q);n=o.pop();){if(n[0]===r)return!!n[1].deleted;o=o.concat(n[2])}}function Z(e){return/^_local/.test(e)}function ee(r,t,n){function o(){i.cancel()}var i,s,e;sr.a.call(this),(i=this).db=r,t=t?N(t):{},s=t.complete=c(function(e,t){var n;e?0<("listenerCount"in(n=i)?n.listenerCount("error"):sr.a.listenerCount(n,"error"))&&i.emit("error",e):i.emit("complete",t),i.removeAllListeners(),r.removeListener("destroyed",o)}),n&&(i.on("complete",function(e){n(null,e)}),i.on("error",n)),r.once("destroyed",o),t.onChange=function(e,t,n){i.isCancelled||function(e,t,n,r){try{e.emit("change",t,n,r)}catch(e){v("error",'Error in .on("change", function):',e)}}(i,e,t,n)},e=new Promise(function(n,r){t.complete=function(e,t){e?r(e):n(t)}}),i.once("cancel",function(){r.removeListener("destroyed",o),t.complete(null,{status:"cancelled"})}),this.then=e.then.bind(e),this.catch=e.catch.bind(e),this.then(function(e){s(null,e)},s),r.taskqueue.isReady?i.validateChanges(t):r.taskqueue.addTask(function(e){e?t.complete(e):i.isCancelled?i.emit("cancel"):i.validateChanges(t)})}function te(e,t,n){var r=[{rev:e._rev}];return"all_docs"===n.style&&(r=$(t.rev_tree).map(function(e){return{rev:e.rev}})),r={id:t.id,changes:r,doc:e},X(t,e._rev)&&(r.deleted=!0),n.conflicts&&(r.doc._conflicts=I(t),r.doc._conflicts.length||delete r.doc._conflicts),r}function ne(e,t){return e<t?-1:t<e?1:0}function re(n,r){return function(e,t){e||t[0]&&t[0].error?((e=e||t[0]).docId=r,n(e)):n(null,t.length?t[0]:t)}}function oe(e,t){var n=ne(e._id,t._id);return 0!==n?n:ne(e._revisions?e._revisions.start:0,t._revisions?t._revisions.start:0)}function ie(){for(var e in sr.a.call(this),ie.prototype)"function"==typeof this[e]&&(this[e]=this[e].bind(this))}function se(){this.isReady=!1,this.failed=!1,this.queue=[]}function ce(e,t){var o,n;if(!(this instanceof ce))return new ce(e,t);if(o=this,t=t||{},e&&"object"==typeof e&&(e=(t=e).name,delete t.name),void 0===t.deterministic_revs&&(t.deterministic_revs=!0),this.__opts=t=N(t),o.auto_compaction=t.auto_compaction,o.prefix=ce.prefix,"string"!=typeof e)throw new Error("Missing/invalid DB name");if(n=function(e,t){var n,r,o,i,s,c=e.match(/([a-z-]*):\/\/(.*)/);if(c)return{name:/https?/.test(c[1])?c[1]+"://"+c[2]:c[2],adapter:c[1]};if(n=ce.adapters,r=ce.preferredAdapters,o=ce.prefix,!(i=t.adapter))for(s=0;s<r.length&&"idb"===(i=r[s])&&"websql"in n&&Ft&&localStorage["_pouch__websqldb_"+o+e];++s)v("log",'PouchDB is downgrading "'+e+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');return{name:(t=n[i])&&"use_prefix"in t&&!t.use_prefix?e:o+e,adapter:i}}((t.prefix||"")+e,t),t.name=n.name,t.adapter=t.adapter||n.adapter,o.name=e,o._adapter=t.adapter,ce.emit("debug",["adapter","Picked adapter: ",t.adapter]),!ce.adapters[t.adapter]||!ce.adapters[t.adapter].valid())throw new Error("Invalid Adapter: "+t.adapter);if(t.view_adapter&&(!ce.adapters[t.view_adapter]||!ce.adapters[t.view_adapter].valid()))throw new Error("Invalid View Adapter: "+t.view_adapter);ie.call(o),o.taskqueue=new se,o.adapter=t.adapter,ce.adapters[t.adapter].call(o,t,function(e){function t(e){r.removeListener("closed",n),e||r.constructor.emit("destroyed",r.name)}function n(){r.removeListener("destroyed",t),r.constructor.emit("unref",r)}return e?o.taskqueue.fail(e):((r=o).once("destroyed",t),r.once("closed",n),r.constructor.emit("ref",r),o.emit("created",o),ce.emit("created",o.name),void o.taskqueue.ready(o));var r})}function ae(e,t){for(var n=e,r=0,o=t.length;r<o&&(n=n[t[r]]);r++);return n}function ue(e){for(var t,n=[],r="",o=0,i=e.length;o<i;o++)t=e[o],0<o&&"\\"===e[o-1]&&("$"===t||"."===t)?r=r.substring(0,r.length-1)+t:"."===t?(n.push(r),r=""):r+=t;return n.push(r),n}function fe(e){return-1<vn.indexOf(e)}function le(e){return Object.keys(e)[0]}function de(e){var n={},o={$or:!0,$nor:!0};return e.forEach(function(t){Object.keys(t).forEach(function(e){var r,u,f=t[e];if("object"!=typeof f&&(f={$eq:f}),fe(e))if(f instanceof Array){if(o[e])return o[e]=!1,void(n[e]=f);r=[],n[e].forEach(function(n){Object.keys(f).forEach(function(e){var t=f[e],e=Math.max(Object.keys(n).length,Object.keys(t).length),t=de([n,t]);Object.keys(t).length<=e||r.push(t)})}),n[e]=r}else n[e]=de([f]);else u=n[e]=n[e]||{},Object.keys(f).forEach(function(e){var t,n,r,o,i,s,c,a=f[e];return"$gt"===e||"$gte"===e?(i=e,s=a,void(void 0===(c=u).$eq&&(void 0!==c.$gte?"$gte"===i?c.$gte<s&&(c.$gte=s):c.$gte<=s&&(delete c.$gte,c.$gt=s):void 0!==c.$gt?"$gte"===i?c.$gt<s&&(delete c.$gt,c.$gte=s):c.$gt<s&&(c.$gt=s):c[i]=s))):"$lt"===e||"$lte"===e?(r=e,o=a,void(void 0===(s=u).$eq&&(void 0!==s.$lte?"$lte"===r?o<s.$lte&&(s.$lte=o):o<=s.$lte&&(delete s.$lte,s.$lt=o):void 0!==s.$lt?"$lte"===r?o<s.$lt&&(delete s.$lt,s.$lte=o):o<s.$lt&&(s.$lt=o):s[r]=o))):"$ne"===e?(r=a,void("$ne"in(o=u)?o.$ne.push(r):o.$ne=[r])):"$eq"===e?(t=a,delete(n=u).$gt,delete n.$gte,delete n.$lt,delete n.$lte,delete n.$ne,void(n.$eq=t)):"$regex"===e?(n=a,void("$regex"in(t=u)?t.$regex.push(n):t.$regex=[n])):void(u[e]=a)})})}),n}function pe(e,t){var n,r;if(e===t)return 0;if(e=he(e),t=he(t),(n=ge(e))-(r=ge(t))!=0)return n-r;switch(typeof e){case"number":return e-t;case"boolean":return e<t?-1:1;case"string":return e===t?0:t<e?1:-1}return(Array.isArray(e)?function(e,t){for(var n,r=Math.min(e.length,t.length),o=0;o<r;o++)if(0!==(n=pe(e[o],t[o])))return n;return e.length===t.length?0:t.length<e.length?1:-1}:function(e,t){for(var n,r=Object.keys(e),o=Object.keys(t),i=Math.min(r.length,o.length),s=0;s<i;s++){if(0!==(n=pe(r[s],o[s])))return n;if(0!==(n=pe(e[r[s]],t[o[s]])))return n}return r.length===o.length?0:o.length<r.length?1:-1})(e,t)}function he(e){var t,n,r,o,i;switch(typeof e){case"undefined":return null;case"number":return e===1/0||e===-1/0||isNaN(e)?null:e;case"object":if(t=e,Array.isArray(e))for(n=e.length,e=new Array(n),r=0;r<n;r++)e[r]=he(t[r]);else{if(e instanceof Date)return e.toJSON();if(null!==e)for(o in e={},t)Object.prototype.hasOwnProperty.call(t,o)&&void 0!==(i=t[o])&&(e[o]=he(i))}}return e}function me(e){return ge(e=he(e))+bn+function(e){var t,n,r,o,i,s,c,a,u,f,l;if(null!==e)switch(typeof e){case"boolean":return e?1:0;case"number":return 0===(c=e)?"1":(u=c.toExponential().split(/e\+?/),a=parseInt(u[1],10),c=(s=c<0)?"0":"2",f=((s?-a:a)-_n).toString(),l=yn,a=function(){for(var e="",t=l-f.length;e.length<t;)e+="0";return e}()+f,c+=bn+a,u=Math.abs(parseFloat(u[0])),u=(u=(u=s?10-u:u).toFixed(20)).replace(/\.?0+$/,""),c+(bn+u));case"string":return e.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":if(n=-1,r=(t=(u=Array.isArray(e))?e:Object.keys(e)).length,o="",u)for(;++n<r;)o+=me(t[n]);else for(;++n<r;)o+=me(i=t[n])+me(e[i]);return o}return""}(e)+"\0"}function ge(e){var t=["boolean","number","string","object"].indexOf(typeof e);return~t?null===e?1:Array.isArray(e)?5:t<3?t+2:t+3:Array.isArray(e)?5:void 0}function ve(s,c,e){return e.every(function(e){var t,n,r=c[e],o=ue(e),i=ae(s,o);return fe(e)?(t=r,n=s,"$or"!==e?"$not"!==e?!t.find(function(e){return ve(n,e,Object.keys(e))}):!ve(n,t,Object.keys(t)):t.some(function(e){return ve(n,e,Object.keys(e))})):_e(r,s,o,i)})}function _e(r,o,i,s){return!r||("object"==typeof r?Object.keys(r).every(function(e){var t,n=r[e];return 0===e.indexOf("$")?ye(e,o,n,i,s):(t=ue(e),!(void 0===s&&"object"!=typeof n&&0<t.length)&&(e=ae(s,t),"object"==typeof n?_e(n,o,i,e):ye("$eq",o,n,t,e)))}):r===s)}function ye(e,t,n,r,o){if(!wn[e])throw new Error('unknown operator "'+e+'" - should be one of $eq, $lte, $lt, $gt, $gte, $exists, $ne, $in, $nin, $size, $mod, $regex, $elemMatch, $type, $allMatch or $all');return wn[e](t,n,r,o)}function be(e){return null!=e}function we(e){return void 0!==e}function ke(e,t){return t.some(function(t){return e instanceof Array?e.some(function(e){return 0===pe(t,e)}):0===pe(t,e)})}function Oe(e,t){if(e.selector&&e.filter&&"_selector"!==e.filter)return t(new Error('selector invalid for filter "'+("string"==typeof e.filter?e.filter:"function")+'"'));t()}function je(e){e.view&&!e.filter&&(e.filter="_view"),e.selector&&!e.filter&&(e.filter="_selector"),e.filter&&"string"==typeof e.filter&&("_view"===e.filter?e.view=o(e.view):e.filter=o(e.filter))}function xe(e,t){return t.filter&&"string"==typeof t.filter&&!t.doc_ids&&!J(e.db)}function Ee(n,r){var e,o,i,s=r.complete;if("_view"===r.filter){if(!r.view||"string"!=typeof r.view)return e=M(Zt,"`view` filter parameter not found or invalid."),s(e);o=a(r.view),n.db.get("_design/"+o[0],function(e,t){if(n.isCancelled)return s(null,{status:"cancelled"});if(e)return s(w(e));e=t&&t.views&&t.views[o[1]]&&t.views[o[1]].map;if(!e)return s(M(Kt,t.views?"missing json key: "+o[1]:"missing json key: views"));r.filter=u(["return function(doc) {",'  "use strict";',"  var emitted = false;","  var emit = function (a, b) {","    emitted = true;","  };","  var view = "+e+";","  view(doc);","  if (emitted) {","    return true;","  }","};"].join("\n"),{}),n.doChanges(r)})}else r.selector?(r.filter=function(e){return function(e,s){function r(t){return i.map(function(e){e=ue(le(e));return ae(t,e)})}var t,n,o,i;if("object"!=typeof s)throw new Error("Selector error: expected a JSON object");return e=[{doc:e}],t={selector:s=function(){var e,t,n,r,o=N(s),i=!1;!function e(t,n){var r,o;for(r in t)"$and"===r&&(n=!0),"object"==typeof(o=t[r])&&(n=e(o,n));return n}(o,!1)||("$and"in(o=function e(t){var n,r,o;for(n in t){if(Array.isArray(t))for(r in t)t[r].$and&&(t[r]=de(t[r].$and));"object"==typeof(o=t[n])&&e(o)}return t}(o))&&(o=de(o.$and)),i=!0),["$or","$nor"].forEach(function(e){e in o&&o[e].forEach(function(e){for(var t,n,r=Object.keys(e),o=0;o<r.length;o++)"object"==typeof(n=e[t=r[o]])&&null!==n||(e[t]={$eq:n})})}),"$not"in o&&(o.$not=de([o.$not])),e=Object.keys(o);for(t=0;t<e.length;t++)"object"!=typeof(r=o[n=e[t]])||null===r?r={$eq:r}:i||("$ne"in r&&(r.$ne=[r.$ne]),"$regex"in r&&(r.$regex=[r.$regex])),o[n]=r;return o}()},n=Object.keys(s),e=e.filter(function(e){return ve(e.doc,t.selector,n)}),t.sort&&(i=t.sort,e=e.sort(function(e,t){var n=pe(r(e.doc),r(t.doc));return 0!==n?n:(e=e.doc._id)<(t=t.doc._id)?-1:t<e?1:0}),"string"!=typeof t.sort[0]&&"desc"===(o=t.sort[0])[le(o)]&&(e=e.reverse())),(e="limit"in t||"skip"in t?e.slice(o=t.skip||0,("limit"in t?t.limit:e.length)+o):e)&&1===e.length}(e,r.selector)},n.doChanges(r)):(i=a(r.filter),n.db.get("_design/"+i[0],function(e,t){if(n.isCancelled)return s(null,{status:"cancelled"});if(e)return s(w(e));e=t&&t.filters&&t.filters[i[1]];if(!e)return s(M(Kt,t&&t.filters?"missing json key: "+i[1]:"missing json key: filters"));r.filter=u('"use strict";\nreturn '+e+";",{}),n.doChanges(r)}))}function qe(e){return e.reduce(function(e,t){return e[t]=!0,e},{})}function Se(e){var t,n;return/^\d+-/.test(e)?(n=e.indexOf("-"),t=e.substring(0,n),n=e.substring(n+1),{prefix:parseInt(t,10),id:n}):M(nn)}function Ae(e,t,n){var r,o,i,s,c,a,u,f;if(n=n||{deterministic_revs:!0},s={status:"available"},e._deleted&&(s.deleted=!0),t)if(e._id||(e._id=dn()),o=D(e,n.deterministic_revs),e._rev){if((i=Se(e._rev)).error)return i;e._rev_tree=[{pos:i.prefix,ids:[i.id,{status:"missing"},[[o,s,[]]]]}],r=i.prefix+1}else e._rev_tree=[{pos:1,ids:[o,s,[]]}],r=1;else if(e._revisions&&(e._rev_tree=function(e,t){for(var n=e.start-e.ids.length+1,r=e.ids,o=[r[0],t,[]],i=1,s=r.length;i<s;i++)o=[r[i],{status:"missing"},[o]];return[{pos:n,ids:o}]}(e._revisions,s),r=e._revisions.start,o=e._revisions.ids[0]),!e._rev_tree){if((i=Se(e._rev)).error)return i;e._rev_tree=[{pos:r=i.prefix,ids:[o=i.id,s,[]]}]}for(a in _(e._id),e._rev=r+"-"+o,c={metadata:{},data:{}},e)if(Object.prototype.hasOwnProperty.call(e,a)){if((u="_"===a[0])&&!kn[a])throw(f=M(Xt,a)).message=Xt.message+": "+a,f;u&&!On[a]?c.metadata[a.slice(1)]=e[a]:c.data[a]=e[a]}return c}function Pe(e,t,n){if(e.stub)return n();var r,o,i;"string"==typeof e.data?function(t,e,n){var r=function(e){try{return un(e)}catch(e){return{error:M(Yt,"Attachment is not a valid base64 string")}}}(t.data);if(r.error)return n(r.error);t.length=r.length,t.data="blob"===e?O(r,t.content_type):"base64"===e?fn(r):r,K(r,function(e){t.digest="md5-"+e,n()})}(e,t,n):(o=t,i=n,K((r=e).data,function(e){r.digest="md5-"+e,r.length=r.data.size||r.data.length||0,"binary"===o?E(r.data,function(e){r.data=e,i()}):"base64"===o?q(r.data,function(e){r.data=e,i()}):i()}))}function De(t){return function(e){t(M(tn,e.target&&e.target.error?e.target.error.name||e.target.error.message:"unknown_error"))}}function Ce(e,t,n){return{data:function(t){try{return JSON.stringify(t)}catch(e){return rr.a.stringify(t)}}(e),winningRev:t,deletedOrLocal:n?"1":"0",seq:e.seq,id:e.id}}function $e(e){if(!e)return null;var t=function(t){try{return JSON.parse(t)}catch(e){return rr.a.parse(t)}}(e.data);return t.winningRev=e.winningRev,t.deleted="1"===e.deletedOrLocal,t.seq=e.seq,t}function Le(e){if(!e)return e;var t=e._doc_id_rev.lastIndexOf(":");return e._id=e._doc_id_rev.substring(0,t-1),e._rev=e._doc_id_rev.substring(t+1),delete e._doc_id_rev,e}function Be(e,t,n,r){n?r(e?"string"!=typeof e?e:j(e,t):k([""],{type:t})):e?"string"!=typeof e?x(e,function(e){r(fn(e))}):r(e):r("")}function Ie(n,r,o,i){var s,c=Object.keys(n._attachments||{});if(!c.length)return i&&i();s=0,c.forEach(function(e){var t;r.attachments&&r.include_docs?(t=n._attachments[e].digest,o.objectStore(En).get(t)):(n._attachments[e].stub=!0,++s===c.length&&i&&i())})}function Te(e,s){return Promise.all(e.map(function(i){if(i.doc&&i.doc._attachments){var e=Object.keys(i.doc._attachments);return Promise.all(e.map(function(n){var e,r,o=i.doc._attachments[n];if("body"in o)return e=o.body,r=o.content_type,new Promise(function(t){Be(e,r,s,function(e){i.doc._attachments[n]=zt(h(o,["digest","content_type"]),{data:e}),t()})})}))}}))}function Ne(e,t,n){var r=[],o=n.objectStore(xn),i=n.objectStore(En),s=n.objectStore(qn),c=e.length;e.forEach(function(e){o.index("_doc_id_rev").getKey(t+"::"+e).onsuccess=function(e){e=e.target.result;"number"==typeof e?(o.delete(e),s.index("seq").openCursor(IDBKeyRange.only(e))):--c||r.length&&r.forEach(function(t){s.index("digestSeq").count(IDBKeyRange.bound(t+"::",t+"::￿",!1,!1)).onsuccess=function(e){e.target.result||i.delete(t)}})}})}function Re(e,t,n){try{return{txn:e.transaction(t,n)}}catch(e){return{error:e}}}function Me(u,e,f,l,t,n){function r(){var e=Re(t,[jn,xn,En,An,qn,Sn],"readwrite");if(e.error)return n(e.error);(h=e.txn).onabort=De(n),h.ontimeout=De(n),h.oncomplete=o,m=h.objectStore(jn),a=h.objectStore(xn),y=h.objectStore(En),h.objectStore(qn),(s=h.objectStore(Sn)).get(Sn).onsuccess=function(e){g=e.target.result,v()},function(r){var o,i,s=[];if(D.forEach(function(t){t.data&&t.data._attachments&&Object.keys(t.data._attachments).forEach(function(e){e=t.data._attachments[e];e.stub&&s.push(e.digest)})}),!s.length)return r();o=0,s.forEach(function(e){function t(e){e&&!i&&(i=e),++o===s.length&&r(i)}var n;y.get(n=e).onsuccess=function(e){e.target.result?t():((e=M(rn,"unknown stub attachment with digest "+n)).status=412,t(e))}})}(function(e){return e?(O=!0,n(e)):void function(){function t(){function r(){++n===c&&t&&t()}var b,e,o,w,i,k,O,j,t,x,s,n,c;++a===D.length&&(e=D,o=l,w=q,i=h,k=E,O=p,t=d,b=u.revs_limit||1e3,x=(j=f).new_edits,s=new Nt,n=0,c=e.length,e.forEach(function(e,n){var t;e._id&&Z(e._id)?o[e._deleted?"_removeLocal":"_putLocal"](e,{ctx:i},function(e,t){k[n]=e||t,r()}):s.has(t=e.metadata.id)?(c--,s.get(t).push([e,n])):s.set(t,[[e,n]])}),s.forEach(function(g,v){function _(){(++y<g.length?e:r)()}function e(){var e,t,n,r,o,i,s,c,a,u,f,l,d,p=g[y],h=p[0],m=p[1];w.has(v)?(f=b,l=w.get(v),t=k,n=m,r=_,o=O,i=x,function(e,t){for(var n,r,o,i,s=e.slice(),t=t.split("-"),c=parseInt(t[0],10),a=t[1];n=s.pop();){if(n.pos===c&&n.ids[0]===a)return 1;for(o=0,i=(r=n.ids[2]).length;o<i;o++)s.push({pos:n.pos+1,ids:r[o]})}}(l.rev_tree,(e=h).metadata.rev)&&!i?(t[n]=e,r()):(s=l.winningRev||L(l),c="deleted"in l?l.deleted:X(l,s),a="deleted"in e.metadata?e.metadata.deleted:X(e.metadata),p=/^1-/.test(e.metadata.rev),c&&!a&&i&&p&&((p=e.data)._rev=s,p._id=e.metadata.id,e=Ae(p,i)),f=Y(l.rev_tree,e.metadata.rev_tree[0],f),i&&(c&&a&&"new_leaf"!==f.conflicts||!c&&"new_leaf"!==f.conflicts||c&&!a&&"new_branch"===f.conflicts)?(a=M(Ut),t[n]=a,r()):(u=e.metadata.rev,e.metadata.rev_tree=f.tree,e.stemmedRevs=f.stemmedRevs||[],l.rev_map&&(e.metadata.rev_map=l.rev_map),f=L(e.metadata),d=c===(l=X(e.metadata,f))?0:c<l?-1:1,o(e,f,l,u===f?l:X(e.metadata,u),!0,d,n,r)))):(u=Y([],h.metadata.rev_tree[0],b),h.metadata.rev_tree=u.tree,h.stemmedRevs=u.stemmedRevs||[],d=m,n=_,u=L((r=h).metadata),m=X(r.metadata,u),"was_delete"in j&&m?(k[d]=M(Kt,"deleted"),n()):x&&"missing"===r.metadata.rev_tree[0].ids[1].status?(h=M(Ut),k[d]=h,n()):O(r,u,m,m,!1,m?0:1,d,n))}var y=0;e()}))}function e(e){e=$e(e.target.result);e&&q.set(e.id,e),t()}var a,n,r,o;if(D.length)for(n=a=0,r=D.length;n<r;n++)(o=D[n])._id&&Z(o._id)?t():m.get(o.metadata.id).onsuccess=e}()})}function d(){w=!0,v()}function v(){g&&w&&(g.docCount+=k,s.put(g))}function o(){O||(Dn.notify(l._meta.name),n(null,E))}function p(e,t,n,r,o,i,s,c){function a(){m===g.length&&_(l,d,p,h)}function u(){m++,a()}var f,l,d,p,h,m,g;if(e.metadata.winningRev=t,e.metadata.deleted=n,(f=e.data)._id=e.metadata.id,f._rev=e.metadata.rev,r&&(f._deleted=!0),f._attachments&&Object.keys(f._attachments).length)return l=e,d=t,p=n,h=o,m=0,void(g=Object.keys(l.data._attachments)).forEach(function(e){var t,n,r,o=l.data._attachments[e];o.stub?(m++,a()):(e=o.data,delete o.data,o.revpos=parseInt(d,10),n=e,r=u,y.count(t=o.digest).onsuccess=function(e){if(e.target.result)return r();y.put({digest:t,body:n})})});k+=i,v(),_(e,t,n,o)}function _(n,r,o,s){var e,t=n.data,c=n.metadata;t._doc_id_rev=c.id+"::"+c.rev,delete t._id,delete t._rev,(e=a.put(t)).onsuccess=function(e){var i,t=n.stemmedRevs||[];(t=s&&l.auto_compaction?t.concat((i=[],B(n.metadata.rev_tree,function(e,t,n,r,o){"available"!==o.status||e||(i.push(t+"-"+n),o.status="missing")}),i)):t)&&t.length&&Ne(t,n.metadata.id,h),c.seq=e.target.result,e=Ce(c,r,o),m.put(e)},e.onerror=function(e){e.preventDefault(),e.stopPropagation(),a.index("_doc_id_rev").getKey(t._doc_id_rev)}}function i(){A++,j.length===A&&(P?S(P):S())}for(var h,m,a,y,s,c,g,b,w,k,E,q,O,j,x,S,A,P,D=e.docs,C=0,$=D.length;C<$;C++)(b=D[C])._id&&Z(b._id)||(b=D[C]=Ae(b,f.new_edits,u)).error&&!c&&(c=b);if(c)return n(c);w=!1,k=0,E=new Array(D.length),q=new Nt,O=!1,x=l._meta.blobSupport?"blob":"base64",S=function(e){return e?n(e):void r()},(j=D).length?(A=0,j.forEach(function(e){function t(e){P=e,++o===r.length&&i()}var n,r=e.data&&e.data._attachments?Object.keys(e.data._attachments):[],o=0;if(!r.length)return i();for(n in e.data._attachments)Object.prototype.hasOwnProperty.call(e.data._attachments,n)&&Pe(e.data._attachments[n],x,t)})):S()}function Fe(n,r,e,o,i){function s(e){u=e.target.result,a&&i(a,u,f)}function c(e){a=e.target.result,u&&i(a,u,f)}function t(e){e=e.target.result;if(!e)return i();i([e.key],[e.value],e)}var a,u,f;-1===o&&(o=1e3),"function"==typeof n.getAll&&"function"==typeof n.getAllKeys&&1<o&&!e?(f={continue:function(){var e,t;if(!a.length)return i();if(e=a[a.length-1],r&&r.upper)try{t=IDBKeyRange.bound(e,r.upper,!0,r.upperOpen)}catch(e){if("DataError"===e.name&&0===e.code)return i()}else t=IDBKeyRange.lowerBound(e,!0);r=t,u=a=null,n.getAll(r,o).onsuccess=s,n.getAllKeys(r,o).onsuccess=c}},n.getAll(r,o).onsuccess=s,n.getAllKeys(r,o).onsuccess=c):e?n.openCursor(r,"prev").onsuccess=t:n.openCursor(r).onsuccess=t}function ze(i,e,t){function r(e){for(var t,n=0,r=e.length;n<r&&f.length!==E;n++)(t=e[n]).error&&j?f.push(t):function(e,t){var n,r,o={id:t.id,key:t.id,value:{rev:e}};t.deleted?j&&(f.push(o),o.value.deleted=!0,o.doc=null):x--<=0&&(f.push(o),i.include_docs&&(r=o,u.get((n=t).id+"::"+e).onsuccess=function(e){r.doc=Le(e.target.result)||{},!i.conflicts||(e=I(n)).length&&(r.doc._conflicts=e),Ie(r.doc,i,a)}))}((t=$e(t)).winningRev,t)}function n(e,t,n){n&&(r(t),f.length<E&&n.continue())}function o(){var e={total_rows:l,offset:i.skip,rows:f};i.update_seq&&void 0!==d&&(e.update_seq=d),t(null,e)}var s,c,a,u,f,l,d,p,h,m,g,v,_,y,b,w="startkey"in i&&i.startkey,k="endkey"in i&&i.endkey,O="key"in i&&i.key,j="keys"in i&&i.keys,x=i.skip||0,E="number"==typeof i.limit?i.limit:-1;return j||!(c=(s=function(e,t,n,r,o){try{if(e&&t)return o?IDBKeyRange.bound(t,e,!n,!1):IDBKeyRange.bound(e,t,!1,!n);if(e)return o?IDBKeyRange.upperBound(e):IDBKeyRange.lowerBound(e);if(t)return o?IDBKeyRange.lowerBound(t,!n):IDBKeyRange.upperBound(t,!n);if(r)return IDBKeyRange.only(r)}catch(e){return{error:e}}return null}(w,k,!1!==i.inclusive_end,O,i.descending))&&s.error)||"DataError"===c.name&&0===c.code?(k=[jn,xn,Sn],i.attachments&&k.push(En),(O=Re(e,k,"readonly")).error?t(O.error):((a=O.txn).oncomplete=function(){i.attachments?Te(f,i.binary).then(o):o()},a.onabort=De(t),e=a.objectStore(jn),k=a.objectStore(xn),O=a.objectStore(Sn),u=k.index("_doc_id_rev"),f=[],O.get(Sn).onsuccess=function(e){l=e.target.result.docCount},i.update_seq&&(b=function(e){e.target.result&&0<e.target.result.length&&(d=e.target.result[0])},k.openCursor(null,"prev").onsuccess=function(e){e=e.target.result;return b({target:{result:[e&&e.key?e.key:void 0]}})}),!c&&0!==E&&(j?(p=i.keys,h=e,m=n,g=new Array(p.length),v=0,p.forEach(function(t,n){h.get(t).onsuccess=function(e){g[n]=e.target.result||{key:t,error:"not_found"},++v===p.length&&m(p,g,{})}}),0):-1===E?(O=s,_=function(e){e=e.target.result;r(e=i.descending?e.reverse():e)},"function"!=typeof(k=e).getAll?(y=[],k.openCursor(O).onsuccess=function(e){e=e.target.result;e?(y.push(e.value),e.continue()):_({target:{result:y}})}):k.getAll(O).onsuccess=_,0):void Fe(e,s,i.descending,E+x,n)))):t(M(tn,c.name))}function Je(){!Cn&&$n.length&&(Cn=!0,$n.shift()())}function Ke(e,n,r){$n.push(function(){e(function(e,t){!function(e,t,n,r){try{e(t,n)}catch(t){r.emit("error",t)}}(n,e,t,r),Cn=!1,er()(function(){Je()})})}),Je()}function Ue(a,e,t,n){function u(e,t,n,r){return n.seq!==t?r():n.winningRev===e._rev?r(n,e):void i.get(e._id+"::"+n.winningRev)}function r(){a.complete(null,{results:p,last_seq:l})}var o,f,l,d,p,h,m,g,v,_,i;return(a=N(a)).continuous?(o=t+":"+dn(),Dn.addListener(t,o,e,a),Dn.notify(t),{cancel:function(){Dn.removeListener(t,o)}}):(f=a.doc_ids&&new Tt(a.doc_ids),a.since=a.since||0,l=a.since,0===(d="limit"in a?a.limit:-1)&&(d=1),p=[],h=0,m=F(a),g=new Nt,e=[jn,xn],a.attachments&&e.push(En),(e=Re(n,e,"readonly")).error?a.complete(e.error):((v=e.txn).onabort=De(a.complete),v.oncomplete=function(){!a.continuous&&a.attachments?Te(p).then(r):r()},e=v.objectStore(xn),_=v.objectStore(jn),i=e.index("_doc_id_rev"),void Fe(e,a.since&&!a.descending?IDBKeyRange.lowerBound(a.since,!0):null,a.descending,d,function(r,e,i){var s,c,o;i&&r.length&&(s=new Array(r.length),c=new Array(r.length),o=0,e.forEach(function(e,n){!function(t,n,r){if(f&&!f.has(t._id))return r();var o=g.get(t._id);if(o)return u(t,n,o,r);_.get(t._id).onsuccess=function(e){o=$e(e.target.result),g.set(t._id,o),u(t,n,o,r)}}(Le(e),r[n],function(e,t){c[n]=e,s[n]=t,++o===r.length&&function(){for(var e,t,n=[],r=0,o=s.length;r<o&&h!==d;r++)(e=s[r])&&(t=c[r],n.push(function(e,t){var n=a.processChange(t,e,a);return l=n.seq=e.seq,"object"==typeof(e=m(n))?Promise.reject(e):e?(h++,a.return_docs&&p.push(n),a.attachments&&a.include_docs?new Promise(function(e){Ie(t,a,v,function(){Te([n],a.binary).then(function(){e(n)})})}):Promise.resolve(n)):Promise.resolve()}(t,e)));Promise.all(n).then(function(e){for(var t=0,n=e.length;t<n;t++)e[t]&&a.onChange(e[t])}).catch(a.complete),h!==d&&i.continue()}()})}))})))}function He(t,e){var n=this;Ke(function(e){!function(l,r,d){function o(n){return function(e,t){e&&e instanceof Error&&!e.reason&&m&&(e.reason=m),n(e,t)}}function c(e,r){var o=e.objectStore(jn);o.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),o.openCursor().onsuccess=function(e){var t,n=e.target.result;n?(e=X(t=n.value),t.deletedOrLocal=e?"1":"0",o.put(t),n.continue()):r()}}function a(e,s){var c=e.objectStore(An),a=e.objectStore(jn),u=e.objectStore(xn);a.openCursor().onsuccess=function(e){var t,n,r,o,i=e.target.result;i?(e=Z(n=(r=i.value).id),r=L(r),e?(t=n+"::"+r,e=n+"::",r=n+"::~",n=u.index("_doc_id_rev"),r=IDBKeyRange.bound(e,r,!1,!1),(o=n.openCursor(r)).onsuccess=function(e){(o=e.target.result)?((e=o.value)._doc_id_rev===t&&c.put(e),u.delete(o.primaryKey),o.continue()):(a.delete(i.primaryKey),i.continue())}):i.continue()):s&&s()}}function u(e,c){var t=e.objectStore(xn),n=e.objectStore(En),a=e.objectStore(qn);n.count().onsuccess=function(e){if(!e.target.result)return c();t.openCursor().onsuccess=function(e){var t,n,r,o,i,s,e=e.target.result;if(!e)return c();for(t=e.value,n=e.primaryKey,r=Object.keys(t._attachments||{}),o={},i=0;i<r.length;i++)o[t._attachments[r[i]].digest]=!0;for(s=Object.keys(o),i=0;i<s.length;i++)a.put({seq:n,digestSeq:s[i]+"::"+n});e.continue()}}}function f(e){var s=e.objectStore(xn),c=e.objectStore(jn);c.openCursor().onsuccess=function(e){function n(){var e=Ce(r,r.winningRev,r.deleted);c.put(e).onsuccess=function(){i.continue()}}var r,t,o,i=e.target.result;if(i){if((r=(t=i.value).data?$e(t):(t.deleted="1"===t.deletedOrLocal,t)).winningRev=r.winningRev||L(r),r.seq)return n();e=r.id+"::",t=r.id+"::￿",t=s.index("_doc_id_rev").openCursor(IDBKeyRange.bound(e,t)),o=0,t.onsuccess=function(e){var t=e.target.result;if(!t)return r.seq=o,n();o<(e=t.primaryKey)&&(o=e),t.continue()}}}}var e,p=r.name,h=null,m=null;if(l._meta=null,l._remote=!1,l.type=function(){return"idb"},l._id=s(function(e){e(null,l._meta.instanceId)}),l._bulkDocs=function(e,t,n){Me(r,e,t,l,h,o(n))},l._get=function(e,n,t){function r(){t(s,{doc:o,metadata:i,ctx:a})}var o,i,s,c,a=n.ctx;if(!a){if((c=Re(h,[jn,xn,En],"readonly")).error)return t(c.error);a=c.txn}a.objectStore(jn).get(e).onsuccess=function(e){var t;if(!(i=$e(e.target.result)))return s=M(Kt,"missing"),r();if(n.rev)t=n.latest?function(e,t){for(var n,r,o,i,s,c,a,u,f,l,d,p,h=t.rev_tree.slice();n=h.pop();){if(r=n.pos,o=(c=n.ids)[0],i=c[1],c=0===(s=c[2]).length,(a=n.history?n.history.slice():[]).push({id:o,pos:r,opts:i}),c)for(u=0,f=a.length;u<f;u++)if((l=a[u]).pos+"-"+l.id===e)return r+"-"+o;for(d=0,p=s.length;d<p;d++)h.push({pos:r+1,ids:s[d],history:a})}throw new Error("Unable to resolve latest revision for id "+t.id+", rev "+e)}(n.rev,i):n.rev;else if(t=i.winningRev,X(i))return s=M(Kt,"deleted"),r();e=a.objectStore(xn),t=i.id+"::"+t,e.index("_doc_id_rev").get(t).onsuccess=function(e){if(!(o=(o=e.target.result)&&Le(o)))return s=M(Kt,"missing"),r();r()}}},l._getAttachment=function(e,t,n,r,o){var i,s,c;if(r.ctx)i=r.ctx;else{if((s=Re(h,[jn,xn,En],"readonly")).error)return o(s.error);i=s.txn}s=n.digest,c=n.content_type,i.objectStore(En).get(s).onsuccess=function(e){Be(e.target.result.body,c,r.binary,function(e){o(null,e)})}},l._info=function(e){var t,n,r=Re(h,[Sn,xn],"readonly");if(r.error)return e(r.error);(r=r.txn).objectStore(Sn).get(Sn).onsuccess=function(e){n=e.target.result.docCount},r.objectStore(xn).openCursor(null,"prev").onsuccess=function(e){e=e.target.result;t=e?e.key:0},r.oncomplete=function(){e(null,{doc_count:n,update_seq:t,idb_attachment_format:l._meta.blobSupport?"binary":"base64"})}},l._allDocs=function(e,t){ze(e,h,o(t))},l._changes=function(e){return Ue(e,l,p,h)},l._close=function(e){h.close(),Ln.delete(p),e()},l._getRevisionTree=function(e,t){var n=Re(h,[jn],"readonly");if(n.error)return t(n.error);n.txn.objectStore(jn).get(e)},l._doCompaction=function(r,i,e){var o,t=Re(h,[jn,xn,En,qn],"readwrite");if(t.error)return e(t.error);(o=t.txn).objectStore(jn).get(r).onsuccess=function(e){var t,n=$e(e.target.result);B(n.rev_tree,function(e,t,n,r,o){-1!==i.indexOf(t+"-"+n)&&(o.status="missing")}),Ne(i,r,o),t=n.winningRev,e=n.deleted,o.objectStore(jn).put(Ce(n,t,e))},o.onabort=De(e),o.oncomplete=function(){e()}},l._getLocal=function(e,t){var n=Re(h,[An],"readonly");if(n.error)return t(n.error);(e=n.txn.objectStore(An).get(e)).onerror=De(t),e.onsuccess=function(e){e=e.target.result;e?(delete e._doc_id_rev,t(null,e)):t(M(Kt))}},l._putLocal=function(t,e,n){var r,o,i,s,c,a,u;if("function"==typeof e&&(n=e,e={}),delete t._revisions,r=t._rev,o=t._id,t._rev=r?"0-"+(parseInt(r.split("-")[1],10)+1):"0-1",!(i=e.ctx)){if((c=Re(h,[An],"readwrite")).error)return n(c.error);(i=c.txn).onerror=De(n),i.oncomplete=function(){s&&n(null,s)}}a=i.objectStore(An),r?(u=a.get(o)).onsuccess=function(e){e=e.target.result;e&&e._rev===r?a.put(t):n(M(Ut))}:((u=a.add(t)).onerror=function(e){n(M(Ut)),e.preventDefault(),e.stopPropagation()},u.onsuccess=function(){s={ok:!0,id:t._id,rev:t._rev},e.ctx&&n(null,s)})},l._removeLocal=function(t,n,r){var e,o,i,s,c;if("function"==typeof n&&(r=n,n={}),!(c=n.ctx)){if((e=Re(h,[An],"readwrite")).error)return r(e.error);(c=e.txn).oncomplete=function(){o&&r(null,o)}}i=t._id,(c=(s=c.objectStore(An)).get(i)).onerror=De(r),c.onsuccess=function(e){e=e.target.result;e&&e._rev===t._rev?(s.delete(i),o={ok:!0,id:i,rev:"0-0"},n.ctx&&r(null,o)):r(M(Kt))}},l._destroy=function(e,t){var n;Dn.removeAllListeners(p),(n=In.get(p))&&n.result&&(n.result.close(),Ln.delete(p)),(n=indexedDB.deleteDatabase(p)).onsuccess=function(){In.delete(p),Ft&&p in localStorage&&delete localStorage[p],t(null,{ok:!0})},n.onerror=De(t)},e=Ln.get(p))return h=e.idb,l._meta=e.global,er()(function(){d(null,l)});e=indexedDB.open(p,5),In.set(p,e),e.onupgradeneeded=function(e){var n,r,o,t,i,s=e.target.result;if(e.oldVersion<1)return i=(t=s).createObjectStore(jn,{keyPath:"id"}),t.createObjectStore(xn,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),t.createObjectStore(En,{keyPath:"digest"}),t.createObjectStore(Sn,{keyPath:"id",autoIncrement:!1}),t.createObjectStore(Pn),i.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),t.createObjectStore(An,{keyPath:"_id"}),(t=t.createObjectStore(qn,{autoIncrement:!0})).createIndex("seq","seq"),void t.createIndex("digestSeq","digestSeq",{unique:!0});n=e.currentTarget.transaction,e.oldVersion<3&&s.createObjectStore(An,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),e.oldVersion<4&&((s=s.createObjectStore(qn,{autoIncrement:!0})).createIndex("seq","seq"),s.createIndex("digestSeq","digestSeq",{unique:!0})),r=[c,a,u,f],o=e.oldVersion,function e(){var t=r[o-1];o++,t&&t(n,e)}()},e.onsuccess=function(e){function t(){void 0!==c&&o&&(l._meta={name:p,instanceId:a,blobSupport:c},Ln.set(p,{idb:h,global:l._meta}),d(null,l))}function n(){var e;void 0!==s&&void 0!==i&&((e=p+"_id")in i?a=i[e]:i[e]=a=dn(),i.docCount=s,r.objectStore(Sn).put(i))}var r,o,i,s,c,a,u,f;(h=e.target.result).onversionchange=function(){h.close(),Ln.delete(p)},h.onabort=function(e){v("error","Database has a global failure",e.target.error),m=e.target.error,h.close(),Ln.delete(p)},r=h.transaction([Sn,Pn,jn],"readwrite"),o=!1,r.objectStore(Sn).get(Sn).onsuccess=function(e){i=e.target.result||{id:Sn},n()},u=function(e){s=e,n()},r.objectStore(jn).index("deletedOrLocal").count(IDBKeyRange.only("0")).onsuccess=function(e){u(e.target.result)},Bn||(f=r,Bn=new Promise(function(n){var e=k([""]),e=f.objectStore(Pn).put(e,"key");e.onsuccess=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),t=navigator.userAgent.match(/Edge\//);n(t||!e||43<=parseInt(e[1],10))},e.onerror=f.onabort=function(e){e.preventDefault(),e.stopPropagation(),n(!1)}}).catch(function(){return!1})),Bn.then(function(e){c=e,t()}),r.oncomplete=function(){o=!0,t()},r.onabort=De(d)},e.onerror=function(e){e=e.target.error&&e.target.error.message;e?-1!==e.indexOf("stored database is a higher version")&&(e=new Error('This DB was created with the newer "indexeddb" adapter, but you are trying to open it with the older "idb" adapter')):e="Failed to open indexedDB, are you in private browsing mode?",v("error",e),d(M(tn,e))}}(n,t,e)},e,n.constructor)}function We(e){var e=e.doc||e.ok,t=e&&e._attachments;t&&Object.keys(t).forEach(function(e){e=t[e];e.data=j(e.data,e.content_type)})}function Ve(e){return/^_design/.test(e)?"_design/"+encodeURIComponent(e.slice(8)):/^_local/.test(e)?"_local/"+encodeURIComponent(e.slice(7)):encodeURIComponent(e)}function Ge(n){return n._attachments&&Object.keys(n._attachments)?Promise.all(Object.keys(n._attachments).map(function(e){var t=n._attachments[e];if(t.data&&"string"!=typeof t.data)return new Promise(function(e){q(t.data,e)}).then(function(e){t.data=e})})):Promise.resolve()}function Ye(e,t){return Qe(e,e.db+"/"+t)}function Qe(e,t){return e.protocol+"://"+e.host+(e.port?":"+e.port:"")+"/"+e.path+(e.path?"/":"")+t}function Xe(t){return"?"+Object.keys(t).map(function(e){return e+"="+encodeURIComponent(t[e])}).join("&")}function Ze(c,e){function t(e,n){return d(e,or()(function(t){v().then(function(){return n.apply(this,t)}).catch(function(e){t.pop()(e)})})).bind(u)}function g(e,t,n){var r={};return(t=t||{}).headers=t.headers||new mn,t.headers.get("Content-Type")||t.headers.set("Content-Type","application/json"),t.headers.get("Accept")||t.headers.set("Accept","application/json"),s(e,t).then(function(e){return r.ok=e.ok,r.status=e.status,e.json()}).then(function(e){if(r.data=e,!r.ok){r.data.status=r.status;e=w(r.data);if(n)return n(e);throw e}if(Array.isArray(r.data)&&(r.data=r.data.map(function(e){return e.error||e.missing?w(e):e})),!n)return r;n(null,r.data)})}function v(){return c.skip_setup?Promise.resolve():n||((n=g(f).catch(function(e){return e&&e.status&&404===e.status?(y(404,"PouchDB is just detecting if the remote exists."),g(f,{method:"PUT"})):Promise.reject(e)}).catch(function(e){return!(!e||!e.status||412!==e.status)||Promise.reject(e)})).catch(function(){n=null}),n)}function a(e){return e.split("/").map(encodeURIComponent).join("/")}var s,n,r,o,i,u=this,_=(i=c.name,r=c,function(){if(r.prefix){var e=b(r.prefix).protocol;return"http"===e||"https"===e}}()&&(o=r.name.substr(r.prefix.length),i=r.prefix.replace(/\/?$/,"/")+encodeURIComponent(o)),((o=b(i)).user||o.password)&&(o.auth={username:o.user,password:o.password}),i=o.path.replace(/(^\/|\/$)/g,"").split("/"),o.db=i.pop(),-1===o.db.indexOf("%")&&(o.db=encodeURIComponent(o.db)),o.path=i.join("/"),o),f=Ye(_,"");c=N(c),s=function(e,t){var n,r,o,i,s;return(t=t||{}).headers=t.headers||new mn,t.credentials="include",(c.auth||_.auth)&&(r=c.auth||_.auth,o=fn(unescape(encodeURIComponent(r.username+":"+r.password))),t.headers.set("Authorization","Basic "+o)),n=c.headers||{},Object.keys(n).forEach(function(e){t.headers.append(e,n[e])}),s=t,r=-1!==(i="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"").indexOf("msie"),o=-1!==i.indexOf("trident"),i=-1!==i.indexOf("edge"),s=!("method"in s)||"GET"===s.method,(r||o||i)&&s&&(e+=(-1===e.indexOf("?")?"?":"&")+"_nonce="+Date.now()),(c.fetch||hn)(e,t)},er()(function(){e(null,u)}),u._remote=!0,u.type=function(){return"http"},u.id=t("id",function(t){s(Qe(_,"")).then(function(e){return e.json()}).catch(function(){return{}}).then(function(e){e=e&&e.uuid?e.uuid+_.db:Ye(_,"");t(null,e)})}),u.compact=t("compact",function(r,o){"function"==typeof r&&(o=r,r={}),r=N(r),g(Ye(_,"_compact"),{method:"POST"}).then(function(){!function n(){u.info(function(e,t){t&&!t.compact_running?o(null,{ok:!0}):setTimeout(n,r.interval||200)})}()})}),u.bulkGet=d("bulkGet",function(n,s){function e(t){var e={};n.revs&&(e.revs=!0),n.attachments&&(e.attachments=!0),n.latest&&(e.latest=!0),g(Ye(_,"_bulk_get"+Xe(e)),{method:"POST",body:JSON.stringify({docs:n.docs})}).then(function(e){n.attachments&&n.binary&&e.data.results.forEach(function(e){e.docs.forEach(We)}),t(null,e.data)}).catch(t)}function r(){for(var e,r=Math.ceil(n.docs.length/50),o=0,i=new Array(r),t=0;t<r;t++)(e=h(n,["revs","attachments","binary","latest"])).docs=n.docs.slice(50*t,Math.min(n.docs.length,50*(t+1))),p(c,e,function(n){return function(e,t){i[n]=t.results,++o===r&&s(null,{results:z(i)})}}(t))}var c=this,o=Qe(_,""),t=Tn[o];"boolean"!=typeof t?e(function(e,t){e?(Tn[o]=!1,y(e.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),r()):(Tn[o]=!0,s(null,t))}):t?e(s):r()}),u._info=function(t){v().then(function(){return s(Ye(_,""))}).then(function(e){return e.json()}).then(function(e){e.host=Ye(_,""),t(null,e)}).catch(t)},u.fetch=function(t,n){return v().then(function(){var e="/"===t.substring(0,1)?Qe(_,t.substring(1)):Ye(_,t);return s(e,n)})},u.get=t("get",function(t,i,n){function r(r){var l,o=r._attachments,e=o&&Object.keys(o);if(o&&e.length)return l=e.map(function(t){return function(){return n=o[e=t],e=Ve(r._id)+"/"+a(e)+"?rev="+r._rev,s(Ye(_,e)).then(function(e){return"buffer"in e?e.buffer():e.blob()}).then(function(t){if(i.binary){var e=Object.getOwnPropertyDescriptor(t.__proto__,"type");return e&&!e.set||(t.type=n.content_type),t}return new Promise(function(e){q(t,e)})}).then(function(e){delete n.stub,delete n.length,n.data=e});var n,e}}),new Promise(function(e,t){function n(){++u===f?s?t(s):e():i()}function r(){c--,n()}function o(e){c--,s=s||e,n()}function i(){for(;c<5&&a<f;)c++,l[a++]().then(r,o)}var s,c=0,a=0,u=0,f=l.length;i()})}var e;"function"==typeof i&&(n=i,i={}),e={},(i=N(i)).revs&&(e.revs=!0),i.revs_info&&(e.revs_info=!0),i.latest&&(e.latest=!0),i.open_revs&&("all"!==i.open_revs&&(i.open_revs=JSON.stringify(i.open_revs)),e.open_revs=i.open_revs),i.rev&&(e.rev=i.rev),i.conflicts&&(e.conflicts=i.conflicts),i.update_seq&&(e.update_seq=i.update_seq),t=Ve(t),g(Ye(_,t+Xe(e))).then(function(t){return Promise.resolve().then(function(){if(i.attachments)return e=t.data,Array.isArray(e)?Promise.all(e.map(function(e){if(e.ok)return r(e.ok)})):r(e);var e}).then(function(){n(null,t.data)})}).catch(function(e){e.docId=t,n(e)})}),u.remove=t("remove",function(e,t,n,r){var o;"string"==typeof t?(o={_id:e,_rev:t},"function"==typeof n&&(r=n,n={})):(o=e,n="function"==typeof t?(r=t,{}):(r=n,t)),n=o._rev||n.rev,g(Ye(_,Ve(o._id))+"?rev="+n,{method:"DELETE"},r).catch(r)}),u.getAttachment=t("getAttachment",function(e,t,n,r){var o;"function"==typeof n&&(r=n,n={}),n=n.rev?"?rev="+n.rev:"",n=Ye(_,Ve(e))+"/"+a(t)+n,s(n,{method:"GET"}).then(function(e){if(o=e.headers.get("content-type"),e.ok)return void 0===l||l.browser||"function"!=typeof e.buffer?e.blob():e.buffer();throw e}).then(function(e){void 0===l||l.browser||(e.type=o),r(null,e)}).catch(function(e){r(e)})}),u.removeAttachment=t("removeAttachment",function(e,t,n,r){g(Ye(_,Ve(e)+"/"+a(t))+"?rev="+n,{method:"DELETE"},r).catch(r)}),u.putAttachment=t("putAttachment",function(e,t,n,r,o,i){var s;if("function"==typeof o&&(i=o,o=r,r=n,n=null),t=Ve(e)+"/"+a(t),t=Ye(_,t),n&&(t+="?rev="+n),"string"==typeof r){try{s=un(r)}catch(e){return i(M(Yt,"Attachment is not a valid base64 string"))}r=s?O(s,o):""}g(t,{headers:new mn({"Content-Type":o}),method:"PUT",body:r},i).catch(i)}),u._bulkDocs=function(e,t,n){e.new_edits=t.new_edits,v().then(function(){return Promise.all(e.docs.map(Ge))}).then(function(){return g(Ye(_,"_bulk_docs"),{method:"POST",body:JSON.stringify(e)},n)}).catch(n)},u._put=function(t,e,n){v().then(function(){return Ge(t)}).then(function(){return g(Ye(_,Ve(t._id)),{method:"PUT",body:JSON.stringify(t)})}).then(function(e){n(null,e.data)}).catch(function(e){e.docId=t&&t._id,n(e)})},u.allDocs=t("allDocs",function(t,n){var e,r,o;"function"==typeof t&&(n=t,t={}),o={},r="GET",(t=N(t)).conflicts&&(o.conflicts=!0),t.update_seq&&(o.update_seq=!0),t.descending&&(o.descending=!0),t.include_docs&&(o.include_docs=!0),t.attachments&&(o.attachments=!0),t.key&&(o.key=JSON.stringify(t.key)),t.start_key&&(t.startkey=t.start_key),t.startkey&&(o.startkey=JSON.stringify(t.startkey)),t.end_key&&(t.endkey=t.end_key),t.endkey&&(o.endkey=JSON.stringify(t.endkey)),void 0!==t.inclusive_end&&(o.inclusive_end=!!t.inclusive_end),void 0!==t.limit&&(o.limit=t.limit),void 0!==t.skip&&(o.skip=t.skip),o=Xe(o),void 0!==t.keys&&(r="POST",e={keys:t.keys}),g(Ye(_,"_all_docs"+o),{method:r,body:JSON.stringify(e)}).then(function(e){t.include_docs&&t.attachments&&t.binary&&e.data.rows.forEach(We),n(null,e.data)}).catch(n)}),u._changes=function(i){var e,o,s,c,t,a,u,f,l,d,p,h,m="batch_size"in i?i.batch_size:25;if(!(i=N(i)).continuous||"heartbeat"in i||(i.heartbeat=1e4),e="timeout"in i?i.timeout:3e4,"timeout"in i&&i.timeout&&e-i.timeout<5e3&&(e=i.timeout+5e3),"heartbeat"in i&&i.heartbeat&&e-i.heartbeat<5e3&&(e=i.heartbeat+5e3),o={},"timeout"in i&&i.timeout&&(o.timeout=i.timeout),c=s=void 0!==i.limit&&i.limit,i.style&&(o.style=i.style),(i.include_docs||i.filter&&"function"==typeof i.filter)&&(o.include_docs=!0),i.attachments&&(o.attachments=!0),i.continuous&&(o.feed="longpoll"),i.seq_interval&&(o.seq_interval=i.seq_interval),i.conflicts&&(o.conflicts=!0),i.descending&&(o.descending=!0),i.update_seq&&(o.update_seq=!0),"heartbeat"in i&&i.heartbeat&&(o.heartbeat=i.heartbeat),i.filter&&"string"==typeof i.filter&&(o.filter=i.filter),i.view&&"string"==typeof i.view&&(o.filter="_view",o.view=i.view),i.query_params&&"object"==typeof i.query_params)for(t in i.query_params)Object.prototype.hasOwnProperty.call(i.query_params,t)&&(o[t]=i.query_params[t]);return a="GET",i.doc_ids?(o.filter="_doc_ids",a="POST",u={doc_ids:i.doc_ids}):i.selector&&(o.filter="_selector",a="POST",u={selector:i.selector}),f=new pn,p={results:[]},h=function(e,t){var n,r,o;if(!i.aborted){if(o=0,t&&t.results)o=t.results.length,p.last_seq=t.last_seq,r=n=null,"number"==typeof t.pending&&(n=t.pending),"string"!=typeof p.last_seq&&"number"!=typeof p.last_seq||(r=p.last_seq),t.results=t.results.filter(function(e){c--;var t=F(i)(e);return t&&(i.include_docs&&i.attachments&&i.binary&&We(e),i.return_docs&&p.results.push(e),i.onChange(e,n,r)),t});else if(e)return i.aborted=!0,void i.complete(e);t&&t.last_seq&&(l=t.last_seq),o=s&&c<=0||t&&o<m||i.descending,(!i.continuous||s&&c<=0)&&o?i.complete(null,p):er()(function(){d(l,h)})}},(d=function(e,t){var n,r;i.aborted||(o.since=e,"object"==typeof o.since&&(o.since=JSON.stringify(o.since)),i.descending?s&&(o.limit=c):o.limit=!s||m<c?m:c,n=Ye(_,"_changes"+Xe(o)),r={signal:f.signal,method:a,body:JSON.stringify(u)},l=e,i.aborted||v().then(function(){return g(n,r,t)}).catch(t))})(i.since||0,h),{cancel:function(){i.aborted=!0,f.abort()}}},u.revsDiff=t("revsDiff",function(e,t,n){"function"==typeof t&&(n=t,t={}),g(Ye(_,"_revs_diff"),{method:"POST",body:JSON.stringify(e)},n).catch(n)}),u._close=function(e){e()},u._destroy=function(e,t){g(Ye(_,""),{method:"DELETE"}).then(function(e){t(null,e)}).catch(function(e){404===e.status?t(null,{ok:!0}):t(e)})}}function et(e){this.status=400,this.name="query_parse_error",this.message=e,this.error=!0;try{Error.captureStackTrace(this,et)}catch(e){}}function tt(e){this.status=404,this.name="not_found",this.message=e,this.error=!0;try{Error.captureStackTrace(this,tt)}catch(e){}}function nt(e){this.status=500,this.name="invalid_value",this.message=e,this.error=!0;try{Error.captureStackTrace(this,nt)}catch(e){}}function rt(e,t){return t&&e.then(function(e){er()(function(){t(null,e)})},function(e){er()(function(){t(e)})}),e}function ot(n,r){return function(){var e=arguments,t=this;return n.add(function(){return r.apply(t,e)})}}function it(e){var e=new Tt(e),t=new Array(e.size),n=-1;return e.forEach(function(e){t[++n]=e}),t}function st(e){var n=new Array(e.size),r=-1;return e.forEach(function(e,t){n[++r]=t}),n}function ct(e){return new nt("builtin "+e+" function requires map values to be numbers or number arrays")}function at(e){for(var t,n,r,o,i=0,s=0,c=e.length;s<c;s++)if("number"!=typeof(t=e[s])){if(!Array.isArray(t))throw ct("_sum");for(i="number"==typeof i?[i]:i,n=0,r=t.length;n<r;n++){if("number"!=typeof(o=t[n]))throw ct("_sum");void 0===i[n]?i.push(o):i[n]+=o}}else"number"==typeof i?i+=t:i[0]+=t;return i}function ut(e,t){return u("return ("+e.replace(/;\s*$/,"")+");",{emit:t,sum:at,log:Nn,isArray:Rn,toJSON:Mn})}function ft(){this.promise=new Promise(function(e){e()})}function lt(e){if(!e)return"undefined";switch(typeof e){case"function":case"string":return e.toString();default:return JSON.stringify(e)}}function dt(r,o,i,s,t,c){var a,e,u=(e=s,lt(i)+lt(e)+"undefined");return!t&&(a=r._cachedViews=r._cachedViews||{})[u]?a[u]:(e=r.info().then(function(e){var n=e.db_name+"-mrview-"+(t?"temp":P(u));return f(r,"_local/"+c,function(e){var t;if(e.views=e.views||{},-1===(t=o).indexOf("/")&&(t=o+"/"+o),!(t=e.views[t]=e.views[t]||{})[n])return t[n]=!0,e}).then(function(){return r.registerDependentDatabase(n).then(function(e){var t,e=e.db;return e.auto_compaction=!0,(t={name:n,db:e,sourceDB:r,adapter:r.adapter,mapFun:i,reduceFun:s}).db.get("_local/lastSeq").catch(function(e){if(404!==e.status)throw e}).then(function(e){return t.seq=e?e.seq:0,a&&t.db.once("destroyed",function(){delete a[u]}),t})})})}),a&&(a[u]=e),e)}function pt(e){return-1===e.indexOf("/")?[e,e]:e.split("/")}function ht(e,t){try{e.emit("error",t)}catch(e){v("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),v("error",t)}}function mt(e){return/^1-/.test(e)}function gt(t,n){var e=Object.keys(n._attachments);return Promise.all(e.map(function(e){return t.getAttachment(n._id,e,{rev:n._rev})}))}function vt(t,n,r,o,i){return t.get(n).catch(function(e){if(404===e.status)return"http"!==t.adapter&&"https"!==t.adapter||y(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:o,_id:n,history:[],replicator:Un,version:1};throw e}).then(function(e){if(!i.cancelled&&e.last_seq!==r)return e.history=(e.history||[]).filter(function(e){return e.session_id!==o}),e.history.unshift({last_seq:r,session_id:o}),e.history=e.history.slice(0,5),e.version=1,e.replicator=Un,e.session_id=o,e.last_seq=r,t.put(e).catch(function(e){if(409===e.status)return vt(t,n,r,o,i);throw e})})}function _t(e,t,n,r,o){this.src=e,this.target=t,this.id=n,this.returnValue=r,this.opts=o||{}}function yt(e,t){var n=t[0],r=t.slice(1);return!(!e||0===t.length)&&(e===n.session_id||yt(e,r))}function bt(e){return"number"==typeof e.status&&4===Math.floor(e.status/100)}function wt(){var n,r;sr.a.call(this),this.cancelled=!1,this.state="pending",n=this,r=new Promise(function(e,t){n.once("complete",e),n.once("error",t)}),n.then=function(e,t){return r.then(e,t)},n.catch=function(e){return r.catch(e)},n.catch(function(){})}function kt(e,t){return"string"==typeof e?new t.PouchConstructor(e,t):e}function Ot(e,t,n,r){if("function"==typeof n&&(r=n,n={}),(n=void 0===n?{}:n).doc_ids&&!Array.isArray(n.doc_ids))throw M(Zt,"`doc_ids` filter parameter is not a list.");return n.complete=r,(n=N(n)).continuous=n.continuous||n.live,n.retry="retry"in n&&n.retry,n.PouchConstructor=n.PouchConstructor||this,r=new wt,function i(u,f,l,d,s){function e(){return w?Promise.resolve():(e=u,t=f,o=(n=l).doc_ids?n.doc_ids.sort(pe):"",i=n.filter?n.filter.toString():"",a=c=s="",n.selector&&(a=JSON.stringify(n.selector)),n.filter&&n.query_params&&(s=JSON.stringify((r=n.query_params,Object.keys(r).sort(pe).reduce(function(e,t){return e[t]=r[t],e},{})))),n.filter&&"_view"===n.filter&&(c=n.view.toString()),Promise.all([e.id(),t.id()]).then(function(e){var t=e[0]+e[1]+i+c+s+o+a;return new Promise(function(e){K(t,e)})}).then(function(e){return"_local/"+e.replace(/\//g,".").replace(/\+/g,"_")}).then(function(e){w=new _t(u,f,e,d,!1===l.checkpoint?{writeSourceCheckpoint:!1,writeTargetCheckpoint:!1}:"source"===l.checkpoint?{writeSourceCheckpoint:!0,writeTargetCheckpoint:!1}:"target"===l.checkpoint?{writeSourceCheckpoint:!1,writeTargetCheckpoint:!0}:{writeSourceCheckpoint:!0,writeTargetCheckpoint:!0})}));var e,t,n,r,o,i,s,c,a}function n(){var t,e;if(I=[],0!==b.docs.length)return t=b.docs,f.bulkDocs({docs:t,new_edits:!(e={timeout:l.timeout})},e).then(function(e){var r;if(d.cancelled)throw h(),new Error("cancelled");r=Object.create(null),e.forEach(function(e){e.error&&(r[e.id]=e)}),e=Object.keys(r).length,s.doc_write_failures+=e,s.docs_written+=t.length-e,t.forEach(function(e){var t,n=r[e._id];if(n){if(s.errors.push(n),"unauthorized"!==(t=(n.name||"").toLowerCase())&&"forbidden"!==t)throw n;d.emit("denied",N(n))}else I.push(e)})},function(e){throw s.doc_write_failures+=t.length,e})}function r(){if(b.error)throw new Error("There was a problem getting docs.");s.last_seq=S=b.seq;var e=N(s);return I.length&&(e.docs=I,"number"==typeof b.pending&&(e.pending=b.pending,delete b.pending),d.emit("change",e)),x=!0,w.writeCheckpoint(b.seq,T).then(function(){if(d.emit("checkpoint",{checkpoint:b.seq}),x=!1,d.cancelled)throw h(),new Error("cancelled");b=void 0,_()}).catch(function(e){throw y(e),e})}function o(){return function(c,a,r,o){r=N(r);var i=[],u=!0;return Promise.resolve().then(function(){var e=Object.keys(r).filter(function(e){e=r[e].missing;return 1===e.length&&mt(e[0])});if(0<e.length)return c.allDocs({keys:e,include_docs:!0,conflicts:!0}).then(function(e){if(o.cancelled)throw new Error("cancelled");e.rows.forEach(function(e){var t;e.deleted||!e.doc||!mt(e.value.rev)||(t=e.doc)._attachments&&0<Object.keys(t._attachments).length||(t=e.doc)._conflicts&&0<t._conflicts.length||(e.doc._conflicts&&delete e.doc._conflicts,i.push(e.doc),delete r[e.id])})})}).then(function(){var e,n,t=(e=r,n=[],Object.keys(e).forEach(function(t){e[t].missing.forEach(function(e){n.push({id:t,rev:e})})}),{docs:n,revs:!0,latest:!0});if(t.docs.length)return c.bulkGet(t).then(function(e){if(o.cancelled)throw new Error("cancelled");return Promise.all(e.results.map(function(e){return Promise.all(e.docs.map(function(e){var n,r,o,i,s=e.ok;return e.error&&(u=!1),s&&s._attachments?(n=a,o=s,e=J(r=c)&&!J(n),i=Object.keys(o._attachments),(e?n.get(o._id).then(function(t){return Promise.all(i.map(function(e){return t._attachments&&t._attachments[e]&&t._attachments[e].digest===o._attachments[e].digest?n.getAttachment(t._id,e):r.getAttachment(o._id,e)}))}).catch(function(e){if(404!==e.status)throw e;return gt(r,o)}):gt(r,o)).then(function(e){var n=Object.keys(s._attachments);return e.forEach(function(e,t){t=s._attachments[n[t]];delete t.stub,delete t.length,t.data=e}),s})):s}))})).then(function(e){i=i.concat(z(e).filter(Boolean))})})}).then(function(){return{ok:u,docs:i}})}(u,f,b.diffs,d).then(function(e){b.error=!e.ok,e.docs.forEach(function(e){delete b.diffs[e._id],s.docs_read++,b.docs.push(e)})})}function c(){var t;d.cancelled||b||(0!==O.length?(b=O.shift(),d.emit("checkpoint",{start_next_batch:b.seq}),t={},b.changes.forEach(function(e){d.emit("checkpoint",{revs_diff:e}),"_user/"!==e.id&&(t[e.id]=e.changes.map(function(e){return e.rev}))}),f.revsDiff(t).then(function(e){if(d.cancelled)throw h(),new Error("cancelled");b.diffs=e}).then(o).then(n).then(r).then(c).catch(function(e){p("batch processing terminated with error",e)})):a(!0))}function a(e){0!==j.changes.length?(e||E||P<=j.changes.length)&&(O.push(j),j={seq:0,changes:[],docs:[]},"pending"!==d.state&&"stopped"!==d.state||(d.state="active",d.emit("active")),c()):0!==O.length||b||((A&&k.live||E)&&(d.state="pending",d.emit("paused")),E&&h())}function p(e,t){q||(t.message||(t.message=e),s.ok=!1,s.status="aborting",O=[],j={seq:0,changes:[],docs:[]},h(t))}function h(e){var t,n,r,o;q||d.cancelled&&(s.status="cancelled",x)||(s.status=s.status||"complete",s.end_time=(new Date).toISOString(),s.last_seq=S,q=!0,e?((e=M(e)).result=s,"unauthorized"===(t=(e.name||"").toLowerCase())||"forbidden"===t?(d.emit("error",e),d.removeAllListeners()):(r=d,e=e,!1===(n=l).retry?(r.emit("error",e),r.removeAllListeners()):("function"!=typeof n.back_off_function&&(n.back_off_function=R),r.emit("requestError",e),"active"!==r.state&&"pending"!==r.state||(r.emit("paused",e),r.state="stopped",o=function(){n.current_back_off=0},r.once("paused",function(){r.removeListener("active",o)}),r.once("active",o)),n.current_back_off=n.current_back_off||0,n.current_back_off=n.back_off_function(n.current_back_off),setTimeout(function(){i(u,f,l,d)},n.current_back_off)))):(d.emit("complete",s),d.removeAllListeners()))}function m(e,t,n){if(d.cancelled)return h();"number"==typeof t&&(j.pending=t),F(l)(e)&&(j.seq=e.seq||n,j.changes.push(e),d.emit("checkpoint",{pending_batch:j.seq}),er()(function(){a(0===O.length&&k.live)}))}function g(e){if($=!1,d.cancelled)return h();var t;0<e.results.length?(k.since=e.results[e.results.length-1].seq,_(),a(!0)):(t=function(){A?(k.live=!0,_()):E=!0,a(!0)},b||0!==e.results.length?t():(x=!0,w.writeCheckpoint(e.last_seq,T).then(function(){x=!1,s.last_seq=S=e.last_seq,t()}).catch(y)))}function v(e){if($=!1,d.cancelled)return h();p("changes rejected",e)}function _(){function e(){n.cancel()}function t(){d.removeListener("cancel",e)}var n;!$&&!E&&O.length<D&&($=!0,d._changes&&(d.removeListener("cancel",d._abortChanges),d._changes.cancel()),d.once("cancel",e),(n=u.changes(k).on("change",m)).then(t,t),n.then(g).catch(v),l.retry&&(d._changes=n,d._abortChanges=e))}function t(){e().then(function(){return d.cancelled?void h():w.getCheckpoint().then(function(e){k={since:S=e,limit:P,batch_size:P,style:C,doc_ids:L,selector:B,return_docs:!0},l.filter&&("string"!=typeof l.filter?k.include_docs=!0:k.filter=l.filter),"heartbeat"in l&&(k.heartbeat=l.heartbeat),"timeout"in l&&(k.timeout=l.timeout),l.query_params&&(k.query_params=l.query_params),l.view&&(k.view=l.view),_()})}).catch(function(e){p("getCheckpoint rejected with ",e)})}function y(e){x=!1,p("writeCheckpoint completed with error",e)}var b,w,k,O=[],j={seq:0,changes:[],docs:[]},x=!1,E=!1,q=!1,S=0,A=l.continuous||l.live||!1,P=l.batch_size||100,D=l.batches_limit||10,C=l.style||"all_docs",$=!1,L=l.doc_ids,B=l.selector,I=[],T=dn();s=s||{ok:!0,start_time:(new Date).toISOString(),docs_read:0,docs_written:0,doc_write_failures:0,errors:[]},k={},d.ready(u,f),d.cancelled?h():(d._addedListeners||(d.once("cancel",h),"function"==typeof l.complete&&(d.once("error",l.complete),d.once("complete",function(e){l.complete(null,e)})),d._addedListeners=!0),void 0===l.since?t():e().then(function(){return x=!0,w.writeCheckpoint(l.since,T)}).then(function(){x=!1,d.cancelled?h():(S=l.since,t())}).catch(y))}(kt(e,n),kt(t,n),n,r),r}function jt(e,t,n,r){return"function"==typeof n&&(r=n,n={}),(n=N(n=void 0===n?{}:n)).PouchConstructor=n.PouchConstructor||this,new xt(e=kt(e,n),t=kt(t,n),n,r)}function xt(e,t,n,r){function o(e){_.emit("change",{direction:"pull",change:e})}function i(e){_.emit("change",{direction:"push",change:e})}function s(e){_.emit("denied",{direction:"push",doc:e})}function c(e){_.emit("denied",{direction:"pull",doc:e})}function a(){_.pushPaused=!0,_.pullPaused&&_.emit("paused")}function u(){_.pullPaused=!0,_.pushPaused&&_.emit("paused")}function f(){_.pushPaused=!1,_.pullPaused&&_.emit("active",{direction:"push"})}function l(){_.pullPaused=!1,_.pushPaused&&_.emit("active",{direction:"pull"})}function d(n){return function(e,t){("change"!==e||t!==o&&t!==i)&&("denied"!==e||t!==c&&t!==s)&&("paused"!==e||t!==u&&t!==a)&&("active"!==e||t!==l&&t!==f)||(e in g||(g[e]={}),g[e][n]=!0,2===Object.keys(g[e]).length&&_.removeAllListeners(e))}}function p(e,t,n){-1==e.listeners(t).indexOf(n)&&e.on(t,n)}var h,m,g,v,_=this;this.canceled=!1,h=n.push?zt({},n,n.push):n,m=n.pull?zt({},n,n.pull):n,this.push=Ot(e,t,h),this.pull=Ot(t,e,m),this.pushPaused=!0,this.pullPaused=!0,g={},n.live&&(this.push.on("complete",_.pull.cancel.bind(_.pull)),this.pull.on("complete",_.push.cancel.bind(_.push))),this.on("newListener",function(e){"change"===e?(p(_.pull,"change",o),p(_.push,"change",i)):"denied"===e?(p(_.pull,"denied",c),p(_.push,"denied",s)):"active"===e?(p(_.pull,"active",l),p(_.push,"active",f)):"paused"===e&&(p(_.pull,"paused",u),p(_.push,"paused",a))}),this.on("removeListener",function(e){"change"===e?(_.pull.removeListener("change",o),_.push.removeListener("change",i)):"denied"===e?(_.pull.removeListener("denied",c),_.push.removeListener("denied",s)):"active"===e?(_.pull.removeListener("active",l),_.push.removeListener("active",f)):"paused"===e&&(_.pull.removeListener("paused",u),_.push.removeListener("paused",a))}),this.pull.on("removeListener",d("pull")),this.push.on("removeListener",d("push")),v=Promise.all([this.push,this.pull]).then(function(e){e={push:e[0],pull:e[1]};return _.emit("complete",e),r&&r(null,e),_.removeAllListeners(),e},function(e){if(_.cancel(),r?r(e):_.emit("error",e),_.removeAllListeners(),r)throw e}),this.then=function(e,t){return v.then(e,t)},this.catch=function(e){return v.catch(e)}}function Et(e,t){var n=pe(e.key,t.key);return 0!==n?n:pe(e.value,t.value)}function qt(e,t,n){return n=n||0,"number"==typeof t?e.slice(n,t+n):0<n?e.slice(n):e}function St(e){var t=e.value;return t&&"object"==typeof t&&t._id||e.id}function At(t){return function(e){return t.include_docs&&t.attachments&&t.binary&&e.rows.forEach(function(e){var n=e.doc&&e.doc._attachments;n&&Object.keys(n).forEach(function(e){var t=n[e];n[e].data=j(t.data,t.content_type)})}),e}}function Pt(e,t,n,r){t=t[e];void 0!==t&&(r&&(t=encodeURIComponent(JSON.stringify(t))),n.push(e+"="+t))}function Dt(e){if(void 0!==e){var t=Number(e);return isNaN(t)||t!==parseInt(e,10)?e:t}}function Ct(t,e){var n=t.descending?"endkey":"startkey",r=t.descending?"startkey":"endkey";if(void 0!==t[n]&&void 0!==t[r]&&0<pe(t[n],t[r]))throw new et("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");if(e.reduce&&!1!==t.reduce){if(t.include_docs)throw new et("{include_docs:true} is invalid for reduce");if(t.keys&&1<t.keys.length&&!t.group&&!t.group_level)throw new et("Multi-key fetches for reduce views must use {group: true}")}["group_level","limit","skip"].forEach(function(e){e=function(e){if(e)return"number"!=typeof e?new et('Invalid value for integer: "'+e+'"'):e<0?new et('Invalid value for positive integer: "'+e+'"'):void 0}(t[e]);if(e)throw e})}function $t(t){return function(e){if(404===e.status)return t;throw e}}function Lt(e){e="string"==typeof e?e:e.name;return Fn[e]||(Fn[e]=new ft)}function Bt(e,t){return ot(Lt(e),function(){return function(c,o){function i(){return c.sourceDB.changes({return_docs:!0,conflicts:!0,include_docs:!0,style:"all_docs",since:d,limit:o.changes_batch_size}).then(e)}function e(e){var t,r,s,n=e.results;if(n.length&&(t=function(e){for(var t,n,r=new Nt,o=0,i=e.length;o<i;o++)"_"!==(t=e[o]).doc._id[0]&&(a=[],(u=t.doc)._deleted||function(t,e,n){try{e(n)}catch(e){ht(t,e)}}(c.sourceDB,l,u),a.sort(Et),n=function(e){for(var t,n,r,o=new Nt,i=0,s=e.length;i<s;i++)r=[(n=e[i]).key,n.id],0<i&&0===pe(n.key,t)&&r.push(i),o.set(me(r),n),t=n.key;return o}(a),r.set(t.doc._id,[n,t.changes])),d=t.seq;return r}(n),f.add((r=t,s=d,function(){return i=r,n=s,(o=c).db.get("_local/lastSeq").catch($t({_id:"_local/lastSeq",seq:0})).then(function(t){var e=st(i);return Promise.all(e.map(function(e){return n=o,r={_id:t="_local/doc_"+e,keys:[]},e=i.get(e),u=e[0],(1===(e=e[1]).length&&/^1-/.test(e[0].rev)?Promise.resolve(r):n.db.get(t).catch($t(r))).then(function(t){return(t.keys.length?n.db.allDocs({keys:t.keys,include_docs:!0}):Promise.resolve({rows:[]})).then(function(e){return function(e,t){for(var n,r,o,i=[],s=new Tt,c=0,a=t.rows.length;c<a;c++)(n=t.rows[c].doc)&&(i.push(n),s.add(n._id),n._deleted=!u.has(n._id),n._deleted||"value"in(r=u.get(n._id))&&(n.value=r.value));return(o=st(u)).forEach(function(e){var t;s.has(e)||(t={_id:e},"value"in(e=u.get(e))&&(t.value=e.value),i.push(t))}),e.keys=it(o.concat(e.keys)),i.push(e),i}(t,e)})});var n,t,r,u})).then(function(e){e=z(e);return t.seq=n,e.push(t),o.db.bulkDocs({docs:e})})});var o,i,n})),p+=n.length,e={view:c.name,last_seq:e.last_seq,results_count:n.length,indexed_docs:p},c.sourceDB.emit("indexing",e),!(n.length<o.changes_batch_size)))return i()}var a,u,f,l=Gn(c.mapFun,function(e,t){e={id:u._id,key:he(e)};null!=t&&(e.value=he(t)),a.push(e)}),d=c.seq||0;let p=0,t={view:c.name,indexed_docs:p};return c.sourceDB.emit("indexing",t),f=new ft,i().then(function(){return f.finish()}).then(function(){c.seq=d})}(e,t)})()}function It(l,d){return ot(Lt(l),function(){function t(e){return e.include_docs=!0,n.db.allDocs(e).then(function(e){return i=e.total_rows,e.rows.map(function(e){var t,n;return"value"in e.doc&&"object"==typeof e.doc.value&&null!==e.doc.value&&!((n=Object.keys(e.doc.value).sort())<(t=["id","key","value"])||t<n)?e.doc.value:{key:(n=function(e){for(var t,n,r,o,i,s,c,a,u,f,l=[],d=[],p=0;;)if("\0"!==(t=e[p++]))switch(t){case"1":l.push(null);break;case"2":l.push("1"===e[p]),p++;break;case"3":n=function(e,t){var n,r,o,i,s,c=t;if("1"===e[t])n=0,t++;else{for(r="0"===e[t],o="",i=e.substring(++t,t+yn),i=parseInt(i,10)+_n,r&&(i=-i),t+=yn;"\0"!==(s=e[t]);)o+=s,t++;n=1===(o=o.split(".")).length?parseInt(o,10):parseFloat(o[0]+"."+o[1]),r&&(n-=10),0!==i&&(n=parseFloat(n+"e"+i))}return{num:n,length:t-c}}(e,p),l.push(n.num),p+=n.length;break;case"4":for(r="";"\0"!==(o=e[p]);)r+=o,p++;r=r.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),l.push(r);break;case"5":l.push((i={element:[],index:l.length}).element),d.push(i);break;case"6":l.push((i={element:{},index:l.length}).element),d.push(i);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+t)}else{if(1===l.length)return l.pop();c=d,a=u=void 0,f=(s=l).pop(),c.length&&(f===(u=c[c.length-1]).element&&(c.pop(),u=c[c.length-1]),a=u.element,u=u.index,Array.isArray(a)?a.push(f):u===s.length-2?a[s.pop()]=f:s.push(f))}}(e.doc._id))[0],id:n[1],value:"value"in e.doc?e.doc.value:null}})})}function e(t){var e,r=u?function(e,t,n){var r,o,i,s,c,a,u,f;for(0===n.group_level&&delete n.group_level,r=n.group||n.group_level,o=Yn(e.reduceFun),i=[],s=isNaN(n.group_level)?Number.POSITIVE_INFINITY:n.group_level,t.forEach(function(e){var t=i[i.length-1],n=r?e.key:null;if(r&&Array.isArray(n)&&(n=n.slice(0,s)),t&&0===pe(t.groupKey,n))return t.keys.push([e.key,e.id]),void t.values.push(e.value);i.push({keys:[[e.key,e.id]],values:[e.value],groupKey:n})}),t=[],c=0,a=i.length;c<a;c++){if(u=i[c],(f=function(t,e,n,r){try{return{output:e(n,r,!1)}}catch(e){return ht(t,e),{error:e}}}(e.sourceDB,o,u.keys,u.values)).error&&f.error instanceof nt)throw f.error;t.push({value:f.error?null:f.output,key:u.groupKey})}return{rows:qt(t,n.limit,n.skip)}}(n,t,o):void 0===o.keys?{total_rows:i,offset:f,rows:t}:{total_rows:i,offset:f,rows:qt(t,o.limit,o.skip)};return o.update_seq&&(r.update_seq=n.seq),o.include_docs?(e=it(t.map(St)),n.sourceDB.allDocs({keys:e,include_docs:!0,conflicts:o.conflicts,attachments:o.attachments,binary:o.binary}).then(function(e){var n=new Nt;return e.rows.forEach(function(e){n.set(e.id,e.doc)}),t.forEach(function(e){var t=St(e),t=n.get(t);t&&(e.doc=t)}),r})):r}return o=d,u=(n=l).reduceFun&&!1!==o.reduce,f=o.skip||0,void 0===o.keys||o.keys.length||(o.limit=0,delete o.keys),void 0!==o.keys?(s=o.keys.map(function(e){e={startkey:me([e]),endkey:me([e,{}])};return o.update_seq&&(e.update_seq=!0),t(e)}),Promise.all(s).then(z).then(e)):(s={descending:o.descending},o.update_seq&&(s.update_seq=!0),"start_key"in o&&(r=o.start_key),"startkey"in o&&(r=o.startkey),"end_key"in o&&(a=o.end_key),"endkey"in o&&(a=o.endkey),void 0!==r&&(s.startkey=me(o.descending?[r,{}]:[r])),void 0!==a&&(c=!1!==o.inclusive_end,s.endkey=me((c=o.descending?!c:c)?[a,{}]:[a])),void 0!==o.key&&(c=me([o.key]),a=me([o.key,{}]),s.descending?(s.endkey=c,s.startkey=a):(s.startkey=c,s.endkey=a)),u||("number"==typeof o.limit&&(s.limit=o.limit),s.skip=f),t(s).then(e));var n,o,i,r,s,c,a,u,f})()}var Tt,Nt,Rt,Mt,Ft,zt,Jt,Kt,Ut,Ht,Wt,Vt,Gt,Yt,Qt,Xt,Zt,en,tn,nn,rn,on,sn,cn,an,un,fn,ln,dn,pn,hn,mn,gn,vn,_n,yn,bn,wn,kn,On,jn,xn,En,qn,Sn,An,Pn,Dn,Cn,$n,Ln,Bn,In,Tn,Nn,Rn,Mn,Fn,zn,Jn,Kn,Un,Hn,Wn,Vn,Gn,Yn,Qn,Xn,Zn=ar(54),er=ar.n(Zn),tr=ar(321),Zn=ar(137),nr=ar.n(Zn),Zn=ar(180),rr=ar.n(Zn),Zn=ar(76),or=ar.n(Zn),Zn=ar(52),ir=ar.n(Zn),Zn=ar(38),sr=ar.n(Zn);r.prototype.get=function(e){return this._store["$"+e]},r.prototype.set=function(e,t){return this._store["$"+e]=t,!0},r.prototype.has=function(e){return"$"+e in this._store},r.prototype.keys=function(){return Object.keys(this._store).map(e=>i(e))},r.prototype.delete=function(e){var t="$"+e,e=t in this._store;return delete this._store[t],e},r.prototype.forEach=function(e){for(var t,n=Object.keys(this._store),r=0,o=n.length;r<o;r++)e(this._store[t=n[r]],i(t))},Object.defineProperty(r.prototype,"size",{get:function(){return Object.keys(this._store).length}}),e.prototype.add=function(e){return this._store.set(e,!0)},e.prototype.has=function(e){return this._store.has(e)},e.prototype.forEach=function(n){this._store.forEach(function(e,t){n(t)})},Object.defineProperty(e.prototype,"size",{get:function(){return this._store.size}}),Nt=function(){if("undefined"!=typeof Symbol&&"undefined"!=typeof Map&&"undefined"!=typeof Set){var e=Object.getOwnPropertyDescriptor(Map,Symbol.species);return e&&"get"in e&&Map[Symbol.species]===Map}}()?(Tt=Set,Map):(Tt=e,r),Rt=Function.prototype.toString,Mt=Rt.call(Object);try{localStorage.setItem("_pouch_check_localstorage",1),Ft=!!localStorage.getItem("_pouch_check_localstorage")}catch(e){Ft=!1}ir()(t,sr.a),t.prototype.addListener=function(e,t,n,r){function o(){var e;i._listeners[t]&&(s?s="waiting":(s=!0,e=h(r,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary","return_docs"]),n.changes(e).on("change",function(e){r.since<e.seq&&!r.cancelled&&(r.since=e.seq,r.onChange(e))}).on("complete",function(){"waiting"===s&&er()(o),s=!1}).on("error",function(){s=!1})))}var i,s;this._listeners[t]||(s=!1,(i=this)._listeners[t]=o,this.on(e,o))},t.prototype.removeListener=function(e,t){t in this._listeners&&(sr.a.prototype.removeListener.call(this,e,this._listeners[t]),delete this._listeners[t])},t.prototype.notifyLocalWindows=function(e){Ft&&(localStorage[e]="a"===localStorage[e]?"b":"a")},t.prototype.notify=function(e){this.emit(e),this.notifyLocalWindows(e)},Zn="function"==typeof Object.assign?Object.assign:function(e){for(var t,n,r=Object(e),o=1;o<arguments.length;o++)if(null!=(t=arguments[o]))for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r},zt=Zn,ir()(n,Error),n.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})},new n(401,"unauthorized","Name or password is incorrect."),Jt=new n(400,"bad_request","Missing JSON list of 'docs'"),Kt=new n(404,"not_found","missing"),Ut=new n(409,"conflict","Document update conflict"),Ht=new n(400,"bad_request","_id field must contain a string"),Wt=new n(412,"missing_id","_id is required for puts"),Vt=new n(400,"bad_request","Only reserved document ids may start with underscore."),new n(412,"precondition_failed","Database not open"),Gt=new n(500,"unknown_error","Database encountered an unknown error"),Yt=new n(500,"badarg","Some query argument is invalid"),new n(400,"invalid_request","Request was invalid"),Qt=new n(400,"query_parse_error","Some query parameter is invalid"),Xt=new n(500,"doc_validation","Bad special document member"),Zt=new n(400,"bad_request","Something wrong with the request"),en=new n(400,"bad_request","Document must be a JSON object"),new n(404,"not_found","Database not found"),tn=new n(500,"indexed_db_went_bad","unknown"),new n(500,"web_sql_went_bad","unknown"),new n(500,"levelDB_went_went_bad","unknown"),new n(403,"forbidden","Forbidden by design doc validate_doc_update function"),nn=new n(400,"bad_request","Invalid rev format"),new n(412,"file_exists","The database could not be created, the file already exists."),rn=new n(412,"missing_stub","A pre-existing attachment stub wasn't found"),new n(413,"invalid_url","Provided URL is invalid"),on=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],sn="queryKey",cn=/(?:^|&)([^&=]*)=?([^&]*)/g,an=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,un=function(e){return atob(e)},fn=function(e){return btoa(e)},ln=self.setImmediate||self.setTimeout,dn=tr.a,ir()(ee,sr.a),ee.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},ee.prototype.validateChanges=function(t){var n=t.complete,r=this;ce._changesFilterPlugin?ce._changesFilterPlugin.validate(t,function(e){return e?n(e):void r.doChanges(t)}):r.doChanges(t)},ee.prototype.doChanges=function(t){var n,r,o=this,i=t.complete;if("live"in(t=N(t))&&!("continuous"in t)&&(t.continuous=t.live),t.processChange=te,"latest"===t.since&&(t.since="now"),t.since||(t.since=0),"now"!==t.since){if(ce._changesFilterPlugin){if(ce._changesFilterPlugin.normalize(t),ce._changesFilterPlugin.shouldFilter(this,t))return ce._changesFilterPlugin.filter(this,t)}else["doc_ids","filter","selector","view"].forEach(function(e){e in t&&v("warn",'The "'+e+'" option was passed in to changes/replicate, but pouchdb-changes-filter plugin is not installed, so it was ignored. Please install the plugin to enable filtering.')});"descending"in t||(t.descending=!1),t.limit=0===t.limit?1:t.limit,t.complete=i,(n=this.db._changes(t))&&"function"==typeof n.cancel&&(r=o.cancel,o.cancel=or()(function(e){n.cancel(),r.apply(this,e)}))}else this.db.info().then(function(e){o.isCancelled?i(null,{status:"cancelled"}):(t.since=e.update_seq,o.doChanges(t))},i)},ir()(ie,sr.a),ie.prototype.post=d("post",function(e,t,n){return"function"==typeof t&&(n=t,t={}),"object"!=typeof e||Array.isArray(e)?n(M(en)):void this.bulkDocs({docs:[e]},t,re(n,e._id))}),ie.prototype.put=d("put",function(t,n,r){function e(e){"function"==typeof c._put&&!1!==n.new_edits?c._put(t,n,e):c.bulkDocs({docs:[t]},n,re(e,t._id))}if("function"==typeof n&&(r=n,n={}),"object"!=typeof t||Array.isArray(t))return r(M(en));if(_(t._id),Z(t._id)&&"function"==typeof this._putLocal)return t._deleted?this._removeLocal(t,r):this._putLocal(t,r);var o,i,s,c=this;n.force&&t._rev?(o=(s=t._rev.split("-"))[1],i=parseInt(s[0],10)+1,s=D(),t._revisions={start:i,ids:[s,o]},t._rev=i+"-"+s,n.new_edits=!1,e(function(e){r(e,e?null:{ok:!0,id:t._id,rev:t._rev})})):e(r)}),ie.prototype.putAttachment=d("putAttachment",function(t,n,r,o,i){function s(e){var t="_rev"in e?parseInt(e._rev,10):0;return e._attachments=e._attachments||{},e._attachments[n]={content_type:i,data:o,revpos:++t},c.put(e)}var c=this;return"function"==typeof i&&(i=o,o=r,r=null),void 0===i&&(i=o,o=r,r=null),i||v("warn","Attachment",n,"on document",t,"is missing content_type"),c.get(t).then(function(e){if(e._rev!==r)throw M(Ut);return s(e)},function(e){if(e.reason===Kt.message)return s({_id:t});throw e})}),ie.prototype.removeAttachment=d("removeAttachment",function(e,n,r,o){var i=this;i.get(e,function(e,t){if(e)o(e);else if(t._rev===r){if(!t._attachments)return o();delete t._attachments[n],0===Object.keys(t._attachments).length&&delete t._attachments,i.put(t,o)}else o(M(Ut))})}),ie.prototype.remove=d("remove",function(e,t,n,r){var o;return"string"==typeof t?(o={_id:e,_rev:t},"function"==typeof n&&(r=n,n={})):(o=e,n="function"==typeof t?(r=t,{}):(r=n,t)),(n=n||{}).was_delete=!0,Z((t={_id:o._id,_rev:o._rev||n.rev,_deleted:!0})._id)&&"function"==typeof this._removeLocal?this._removeLocal(o,r):void this.bulkDocs({docs:[t]},n,re(r,t._id))}),ie.prototype.revsDiff=d("revsDiff",function(o,e,c){function a(e,t){l.has(e)||l.set(e,{missing:[]}),l.get(e).missing.push(t)}var u,f,l;return"function"==typeof e&&(c=e,e={}),(u=Object.keys(o)).length?(f=0,l=new Nt,void u.map(function(r){this._getRevisionTree(r,function(e,t){var i,s,n;if(e&&404===e.status&&"missing"===e.message)l.set(r,{missing:o[r]});else{if(e)return c(e);t=t,s=o[i=r].slice(0),B(t,function(e,t,n,r,o){t=t+"-"+n,n=s.indexOf(t);-1!==n&&(s.splice(n,1),"available"!==o.status&&a(i,t))}),s.forEach(function(e){a(i,e)})}if(++f===u.length)return n={},l.forEach(function(e,t){n[t]=e}),c(null,n)})},this)):c(null,{})}),ie.prototype.bulkGet=d("bulkGet",function(e,t){p(this,e,t)}),ie.prototype.compactDocument=d("compactDocument",function(r,a,u){var f=this;this._getRevisionTree(r,function(e,t){var n,i,s,o,c;return e?u(e):(o={},c=[],B(t,function(e,t,n,r){n=t+"-"+n;return e&&(o[n]=0),void 0!==r&&c.push({from:r,to:n}),n}),c.reverse(),c.forEach(function(e){o[e.from]=void 0===o[e.from]?1+o[e.to]:Math.min(o[e.from],1+o[e.to])}),n=o,i=[],s=[],Object.keys(n).forEach(function(e){a<n[e]&&i.push(e)}),B(t,function(e,t,n,r,o){n=t+"-"+n;"available"===o.status&&-1!==i.indexOf(n)&&s.push(n)}),void f._doCompaction(r,s,u))})}),ie.prototype.compact=d("compact",function(e,t){"function"==typeof e&&(t=e,e={});var n=this;e=e||{},n._compactionQueue=n._compactionQueue||[],n._compactionQueue.push({opts:e,callback:t}),1===n._compactionQueue.length&&function n(r){var e=r._compactionQueue[0],t=e.opts,o=e.callback;r.get("_local/compaction").catch(function(){return!1}).then(function(e){e&&e.last_seq&&(t.last_seq=e.last_seq),r._compact(t,function(e,t){e?o(e):o(null,t),er()(function(){r._compactionQueue.shift(),r._compactionQueue.length&&n(r)})})})}(n)}),ie.prototype._compact=function(e,n){var r=this,o=[];r.changes({return_docs:!1,last_seq:e.last_seq||0}).on("change",function(e){o.push(r.compactDocument(e.id,0))}).on("complete",function(e){var t=e.last_seq;Promise.all(o).then(function(){return f(r,"_local/compaction",function(e){return(!e.last_seq||e.last_seq<t)&&(e.last_seq=t,e)})}).then(function(){n(null,{ok:!0})}).catch(n)}).on("error",n)},ie.prototype.get=d("get",function(v,_,y){function n(){var s=[],c=r.length;if(!c)return y(null,s);r.forEach(function(i){b.get(v,{rev:i,revs:_.revs,latest:_.latest,attachments:_.attachments,binary:_.binary},function(e,t){var n,r,o;if(e)s.push({missing:i});else{for(r=0,o=s.length;r<o;r++)if(s[r].ok&&s[r].ok._rev===t._rev){n=!0;break}n||s.push({ok:t})}--c||y(null,s)})})}var r,b,e,t;if("function"==typeof _&&(y=_,_={}),"string"!=typeof v)return y(M(Ht));if(Z(v)&&"function"==typeof this._getLocal)return this._getLocal(v,y);if(r=[],b=this,!_.open_revs)return this._get(v,_,function(e,t){var o,n,i,r,s,c,a,u,f,l,d,p,h,m,g;if(e)return e.docId=v,y(e);if(o=t.doc,n=t.metadata,i=t.ctx,_.conflicts&&(r=I(n)).length&&(o._conflicts=r),X(n,o._rev)&&(o._deleted=!0),_.revs||_.revs_info){for(r=o._rev.split("-"),s=parseInt(r[0],10),c=r[1],a=T(n.rev_tree),u=null,f=0;f<a.length;f++)(d=(l=a[f]).ids.map(function(e){return e.id}).indexOf(c))!==s-1&&(u||-1===d)||(u=l);if(!u)return(e=new Error("invalid rev tree")).docId=v,y(e);e=u.ids.map(function(e){return e.id}).indexOf(o._rev.split("-")[1])+1,u.ids.splice(e,u.ids.length-e),u.ids.reverse(),_.revs&&(o._revisions={start:u.pos+u.ids.length-1,ids:u.ids.map(function(e){return e.id})}),_.revs_info&&(p=u.pos+u.ids.length,o._revs_info=u.ids.map(function(e){return{rev:--p+"-"+e.id,status:e.opts.status}}))}if(_.attachments&&o._attachments){if(h=o._attachments,0===(m=Object.keys(h).length))return y(null,o);Object.keys(h).forEach(function(r){this._getAttachment(o._id,r,h[r],{rev:o._rev,binary:_.binary,ctx:i},function(e,t){var n=o._attachments[r];n.data=t,delete n.stub,delete n.length,--m||y(null,o)})},b)}else{if(o._attachments)for(g in o._attachments)Object.prototype.hasOwnProperty.call(o._attachments,g)&&(o._attachments[g].stub=!0);y(null,o)}});if("all"===_.open_revs)this._getRevisionTree(v,function(e,t){return e?y(e):(r=$(t).map(function(e){return e.rev}),void n())});else{if(!Array.isArray(_.open_revs))return y(M(Gt,"function_clause"));for(r=_.open_revs,e=0;e<r.length;e++)if("string"!=typeof(t=r[e])||!/^\d+-/.test(t))return y(M(nn));n()}}),ie.prototype.getAttachment=d("getAttachment",function(n,r,o,i){var s=this;o instanceof Function&&(i=o,o={}),this._get(n,o,function(e,t){return e?i(e):t.doc._attachments&&t.doc._attachments[r]?(o.ctx=t.ctx,o.binary=!0,void s._getAttachment(n,r,t.doc._attachments[r],o,i)):i(M(Kt))})}),ie.prototype.allDocs=d("allDocs",function(t,e){var n,r;if("function"==typeof t&&(e=t,t={}),t.skip=void 0!==t.skip?t.skip:0,t.start_key&&(t.startkey=t.start_key),t.end_key&&(t.endkey=t.end_key),"keys"in t){if(!Array.isArray(t.keys))return e(new TypeError("options.keys must be an array"));if(r=["startkey","endkey","key"].filter(function(e){return e in t})[0])return void e(M(Qt,"Query parameter `"+r+"` is not compatible with multi-get"));if(!J(this)&&(r="limit"in(n=t)?n.keys.slice(n.skip,n.limit+n.skip):0<n.skip?n.keys.slice(n.skip):n.keys,n.keys=r,n.skip=0,delete n.limit,n.descending&&(r.reverse(),n.descending=!1),0===t.keys.length))return this._allDocs({limit:0},e)}return this._allDocs(t,e)}),ie.prototype.changes=function(e,t){return"function"==typeof e&&(t=e,e={}),(e=e||{}).return_docs="return_docs"in e?e.return_docs:!e.live,new ee(this,e,t)},ie.prototype.close=d("close",function(e){return this._closed=!0,this.emit("closed"),this._close(e)}),ie.prototype.info=d("info",function(n){var r=this;this._info(function(e,t){return e?n(e):(t.db_name=t.db_name||r.name,t.auto_compaction=!(!r.auto_compaction||J(r)),t.adapter=r.adapter,void n(null,t))})}),ie.prototype.id=d("id",function(e){return this._id(e)}),ie.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},ie.prototype.bulkDocs=d("bulkDocs",function(e,o,i){var t,r,s,c;if("function"==typeof o&&(i=o,o={}),o=o||{},!(e=Array.isArray(e)?{docs:e}:e)||!e.docs||!Array.isArray(e.docs))return i(M(Jt));for(t=0;t<e.docs.length;++t)if("object"!=typeof e.docs[t]||Array.isArray(e.docs[t]))return i(M(en));return e.docs.forEach(function(n){n._attachments&&Object.keys(n._attachments).forEach(function(e){var t;r=r||"_"===(t=e).charAt(0)&&t+" is not a valid attachment name, attachment names cannot start with '_'",n._attachments[e].content_type||v("warn","Attachment",e,"on document",n._id,"is missing content_type")})}),r?i(M(Zt,r)):("new_edits"in o||("new_edits"in e?o.new_edits=e.new_edits:o.new_edits=!0),s=this,o.new_edits||J(s)||e.docs.sort(oe),function(e){for(var t,n,r,o,i=0;i<e.length;i++)if((t=e[i])._deleted)delete t._attachments;else if(t._attachments)for(n=Object.keys(t._attachments),r=0;r<n.length;r++)t._attachments[o=n[r]]=h(t._attachments[o],["data","digest","content_type","length","revpos","stub"])}(e.docs),c=e.docs.map(function(e){return e._id}),this._bulkDocs(e,o,function(e,t){if(e)return i(e);if(o.new_edits||(t=t.filter(function(e){return e.error})),!J(s))for(var n=0,r=t.length;n<r;n++)t[n].id=t[n].id||c[n];i(null,t)}))}),ie.prototype.registerDependentDatabase=d("registerDependentDatabase",function(t,e){var n,r=N(this.__opts);this.__opts.view_adapter&&(r.adapter=this.__opts.view_adapter),n=new this.constructor(t,r),f(this,"_local/_pouch_dependentDbs",function(e){return e.dependentDbs=e.dependentDbs||{},!e.dependentDbs[t]&&(e.dependentDbs[t]=!0,e)}).then(function(){e(null,{db:n})}).catch(e)}),ie.prototype.destroy=d("destroy",function(e,r){function o(){i._destroy(e,function(e,t){return e?r(e):(i._destroyed=!0,i.emit("destroyed"),void r(null,t||{ok:!0}))})}var i,s;return"function"==typeof e&&(r=e,e={}),s=!("use_prefix"in(i=this))||i.use_prefix,J(i)?o():void i.get("_local/_pouch_dependentDbs",function(e,t){var n;return e?404!==e.status?r(e):o():(n=i.constructor,t=Object.keys(t.dependentDbs).map(function(e){e=s?e.replace(new RegExp("^"+n.prefix),""):e;return new n(e,i.__opts).destroy()}),void Promise.all(t).then(o,r))})}),se.prototype.execute=function(){var e;if(this.failed)for(;e=this.queue.shift();)e(this.failed);else for(;e=this.queue.shift();)e()},se.prototype.fail=function(e){this.failed=e,this.execute()},se.prototype.ready=function(e){this.isReady=!0,this.db=e,this.execute()},se.prototype.addTask=function(e){this.queue.push(e),this.failed&&this.execute()},ir()(ce,ie),pn="undefined"!=typeof AbortController?AbortController:function(){return{abort:function(){}}},hn=fetch,mn=Headers,ce.adapters={},ce.preferredAdapters=[],ce.prefix="_pouch_",gn=new sr.a,function(t){Object.keys(sr.a.prototype).forEach(function(e){"function"==typeof sr.a.prototype[e]&&(t[e]=gn[e].bind(gn))});var r=t._destructionListeners=new Nt;t.on("ref",function(e){r.has(e.name)||r.set(e.name,[]),r.get(e.name).push(e)}),t.on("unref",function(e){var t,n;r.has(e.name)&&((n=(t=r.get(e.name)).indexOf(e))<0||(t.splice(n,1),1<t.length?r.set(e.name,t):r.delete(e.name)))}),t.on("destroyed",function(e){var t;r.has(e)&&(t=r.get(e),r.delete(e),t.forEach(function(e){e.emit("destroyed",!0)}))})}(ce),ce.adapter=function(e,t,n){t.valid()&&(ce.adapters[e]=t,n&&ce.preferredAdapters.push(e))},ce.plugin=function(t){if("function"==typeof t)t(ce);else{if("object"!=typeof t||0===Object.keys(t).length)throw new Error('Invalid plugin: got "'+t+'", expected an object or a function');Object.keys(t).forEach(function(e){ce.prototype[e]=t[e]})}return this.__defaults&&(ce.__defaults=zt({},this.__defaults)),ce},ce.defaults=function(e){function n(e,t){if(!(this instanceof n))return new n(e,t);t=t||{},e&&"object"==typeof e&&(e=(t=e).name,delete t.name),t=zt({},n.__defaults,t),ce.call(this,e,t)}return ir()(n,ce),n.preferredAdapters=ce.preferredAdapters.slice(),Object.keys(ce).forEach(function(e){e in n||(n[e]=ce[e])}),n.__defaults=zt({},this.__defaults,e),n},ce.fetch=function(e,t){return hn(e,t)},vn=["$or","$nor","$not"],_n=-324,yn=3,bn="",wn={$elemMatch:function(t,n,r,e){return!!Array.isArray(e)&&0!==e.length&&e.some("object"==typeof e[0]?function(e){return ve(e,n,Object.keys(n))}:function(e){return _e(n,t,r,e)})},$allMatch:function(t,n,r,e){return!!Array.isArray(e)&&0!==e.length&&e.every("object"==typeof e[0]?function(e){return ve(e,n,Object.keys(n))}:function(e){return _e(n,t,r,e)})},$eq:function(e,t,n,r){return we(r)&&0===pe(r,t)},$gte:function(e,t,n,r){return we(r)&&0<=pe(r,t)},$gt:function(e,t,n,r){return we(r)&&0<pe(r,t)},$lte:function(e,t,n,r){return we(r)&&pe(r,t)<=0},$lt:function(e,t,n,r){return we(r)&&pe(r,t)<0},$exists:function(e,t,n,r){return t?we(r):!we(r)},$mod:function(e,t,n,r){return be(r)&&(t=t,"number"==typeof(r=r)&&parseInt(r,10)===r&&r%t[0]===t[1])},$ne:function(e,t,n,r){return t.every(function(e){return 0!==pe(r,e)})},$in:function(e,t,n,r){return be(r)&&ke(r,t)},$nin:function(e,t,n,r){return be(r)&&!ke(r,t)},$size:function(e,t,n,r){return be(r)&&Array.isArray(r)&&r.length===t},$all:function(e,t,n,r){return Array.isArray(r)&&(o=r,t.every(function(t){return o.some(function(e){return 0===pe(t,e)})}));var o},$regex:function(e,t,n,r){return be(r)&&"string"==typeof r&&t.every(function(e){return t=r,new RegExp(e).test(t);var t})},$type:function(e,t,n,r){return function(e){switch(t){case"null":return null===e;case"boolean":return"boolean"==typeof e;case"number":return"number"==typeof e;case"string":return"string"==typeof e;case"array":return e instanceof Array;case"object":return"[object Object]"==={}.toString.call(e)}}(r)}},ce.plugin(function(e){e._changesFilterPlugin={validate:Oe,normalize:je,shouldFilter:xe,filter:Ee}}),ce.version="7.3.0",kn=qe(["_id","_rev","_access","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),On=qe(["_access","_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),jn="document-store",xn="by-sequence",En="attach-store",qn="attach-seq-store",Sn="meta-store",An="local-store",Pn="detect-blob-support",Dn=new t,Cn=!1,$n=[],Ln=new Nt,In=new Nt,He.valid=function(){try{return"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}},Tn={},Ze.valid=function(){return!0},ir()(et,Error),ir()(tt,Error),ir()(nt,Error),Nn=v.bind(null,"log"),Rn=Array.isArray,Mn=JSON.parse,ft.prototype.add=function(e){return this.promise=this.promise.catch(function(){}).then(function(){return e()}),this.promise},ft.prototype.finish=function(){return this.promise},Fn={},zn=new ft,Jn={_sum:function(e,t){return at(t)},_count:function(e,t){return t.length},_stats:function(e,t){return{sum:at(t),min:Math.min.apply(null,t),max:Math.max.apply(null,t),count:t.length,sumsqr:function(e){for(var t,n=0,r=0,o=e.length;r<o;r++)n+=(t=e[r])*t;return n}(t)}}},Vn="mrviews",Gn=function(e,t){if("function"!=typeof e||2!==e.length)return ut(e.toString(),t);var n=e;return function(e){return n(e,t)}},Yn=function(e){e=e.toString();return function(e){if(/^_sum/.test(e))return Jn._sum;if(/^_count/.test(e))return Jn._count;if(/^_stats/.test(e))return Jn._stats;if(/^_/.test(e))throw new Error(e+" is not a supported reduce function.")}(e)||ut(e)},Qn=function(e,t){var n=e.views&&e.views[t];if("string"!=typeof n.map)throw new tt("ddoc "+e._id+" has no string view named "+t+", instead found object of type: "+typeof n.map)},Kn={query:function(_,y,e){var t,b=this;return"function"==typeof y&&(e=y,y={}),y=y?((t=y).group_level=Dt(t.group_level),t.limit=Dt(t.limit),t.skip=Dt(t.skip),t):{},"function"==typeof _&&(_={map:_}),rt(t=Promise.resolve().then(function(){return e=_,r=y,"function"==typeof(n=b)._query?(t=n,c=e,a=r,new Promise(function(n,r){t._query(c,a,function(e,t){return e?r(e):void n(t)})})):J(n)?(u=n,f=e,v="GET",Pt("reduce",l=r,g=[]),Pt("include_docs",l,g),Pt("attachments",l,g),Pt("limit",l,g),Pt("descending",l,g),Pt("group",l,g),Pt("group_level",l,g),Pt("skip",l,g),Pt("stale",l,g),Pt("conflicts",l,g),Pt("startkey",l,g,!0),Pt("start_key",l,g,!0),Pt("endkey",l,g,!0),Pt("end_key",l,g,!0),Pt("inclusive_end",l,g),Pt("key",l,g,!0),Pt("update_seq",l,g),g=""===(g=g.join("&"))?"":"?"+g,void 0!==l.keys&&((m="keys="+encodeURIComponent(JSON.stringify(l.keys))).length+g.length+1<=2e3?g+=("?"===g[0]?"&":"?")+m:(v="POST","string"==typeof f?d={keys:l.keys}:f.keys=l.keys)),"string"==typeof f?(m=pt(f),u.fetch("_design/"+m[0]+"/_view/"+m[1]+g,{headers:new mn({"Content-Type":"application/json"}),method:v,body:JSON.stringify(d)}).then(function(e){return p=e.ok,h=e.status,e.json()}).then(function(e){if(!p)throw e.status=h,w(e);return e.rows.forEach(function(e){if(e.value&&e.value.error&&"builtin_reduce_error"===e.value.error)throw new Error(e.reason)}),e}).then(At(l))):(d=d||{},Object.keys(f).forEach(function(e){Array.isArray(f[e])?d[e]=f[e]:d[e]=f[e].toString()}),u.fetch("_temp_view"+g,{headers:new mn({"Content-Type":"application/json"}),method:"POST",body:JSON.stringify(d)}).then(function(e){return p=e.ok,h=e.status,e.json()}).then(function(e){if(!p)throw e.status=h,w(e);return e}).then(At(l)))):(o={changes_batch_size:n.__opts.view_update_changes_batch_size||50},"string"!=typeof e?(Ct(r,e),zn.add(function(){return dt(n,"temp_view/temp_view",e.map,e.reduce,!0,Vn).then(function(e){return t=Bt(e,o).then(function(){return It(e,r)}),n=function(){return e.db.destroy()},t.then(function(e){return n().then(function(){return e})},function(e){return n().then(function(){throw e})});var t,n})}),zn.finish()):(l=pt(i=e),s=l[1],n.get("_design/"+l[0]).then(function(e){var t=e.views&&e.views[s];if(!t)throw new tt("ddoc "+e._id+" has no view named "+s);return Qn(e,s),Ct(r,t),dt(n,i,t.map,t.reduce,!1,Vn).then(function(e){return"ok"===r.stale||"update_after"===r.stale?("update_after"===r.stale&&er()(function(){Bt(e,o)}),It(e,r)):Bt(e,o).then(function(){return It(e,r)})})})));var n,e,r,o,i,s,t,c,a,u,f,l,d,p,h,m,g,v}),e),t},viewCleanup:(Xn=function(){var e,t,n=this;return"function"==typeof n._viewCleanup?(e=n,new Promise(function(n,r){e._viewCleanup(function(e,t){return e?r(e):void n(t)})})):J(n)?n.fetch("_view_cleanup",{headers:new mn({"Content-Type":"application/json"}),method:"POST"}).then(function(e){return e.json()}):(t=n).get("_local/"+Vn).then(function(s){var e,c=new Nt;return Object.keys(s.views).forEach(function(e){var t=pt(e),n="_design/"+t[0],e=t[1],t=c.get(n);t||(t=new Tt,c.set(n,t)),t.add(e)}),e={keys:st(c),include_docs:!0},t.allDocs(e).then(function(e){var i={};return e.rows.forEach(function(r){var o=r.key.substring(8);c.get(r.key).forEach(function(e){var t,n=o+"/"+e;s.views[n]||(n=e),n=Object.keys(s.views[n]),t=r.doc&&r.doc.views&&r.doc.views[e],n.forEach(function(e){i[e]=i[e]||t})})}),e=Object.keys(i).filter(function(e){return!i[e]}).map(function(e){return ot(Lt(e),function(){return new t.constructor(e,t.__opts).destroy()})()}),Promise.all(e).then(function(){return{ok:!0}})})},$t({ok:!0}))},or()(function(e){var t=e.pop(),e=Xn.apply(this,e);return"function"==typeof t&&rt(e,t),e}))},Zn={query:function(e,t,n){return Kn.query.call(this,e,t,n)},viewCleanup:function(e){return Kn.viewCleanup.call(this,e)}},Un="pouchdb",Hn=0,_t.prototype.writeCheckpoint=function(e,t){var n=this;return this.updateTarget(e,t).then(function(){return n.updateSource(e,t)})},_t.prototype.updateTarget=function(e,t){return this.opts.writeTargetCheckpoint?vt(this.target,this.id,e,t,this.returnValue):Promise.resolve(!0)},_t.prototype.updateSource=function(e,t){if(this.opts.writeSourceCheckpoint){var n=this;return vt(this.src,this.id,e,t,this.returnValue).catch(function(e){if(bt(e))return!(n.opts.writeSourceCheckpoint=!1);throw e})}return Promise.resolve(!0)},Wn={undefined:function(e,t){return 0===pe(e.last_seq,t.last_seq)?t.last_seq:0},1:function(e,t){return(t.session_id===e.session_id?{last_seq:t.last_seq,history:t.history}:function e(t,n){var r=t[0],o=t.slice(1),i=n[0],s=n.slice(1);return r&&0!==n.length?yt(r.session_id,n)?{last_seq:r.last_seq,history:t}:yt(i.session_id,o)?{last_seq:i.last_seq,history:s}:e(o,s):{last_seq:Hn,history:[]}}(t.history,e.history)).last_seq}},_t.prototype.getCheckpoint=function(){var t=this;return t.opts&&t.opts.writeSourceCheckpoint&&!t.opts.writeTargetCheckpoint?t.src.get(t.id).then(function(e){return e.last_seq||Hn}).catch(function(e){if(404!==e.status)throw e;return Hn}):t.target.get(t.id).then(function(n){return t.opts&&t.opts.writeTargetCheckpoint&&!t.opts.writeSourceCheckpoint?n.last_seq||Hn:t.src.get(t.id).then(function(e){if(n.version!==e.version)return Hn;var t=n.version?n.version.toString():"undefined";return t in Wn?Wn[t](n,e):Hn},function(e){if(404===e.status&&n.last_seq)return t.src.put({_id:t.id,last_seq:Hn}).then(function(){return Hn},function(e){return bt(e)?(t.opts.writeSourceCheckpoint=!1,n.last_seq):Hn});throw e})}).catch(function(e){if(404!==e.status)throw e;return Hn})},ir()(wt,sr.a),wt.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},wt.prototype.ready=function(e,t){function n(){o.cancel()}function r(){e.removeListener("destroyed",n),t.removeListener("destroyed",n)}var o=this;o._readyCalled||(o._readyCalled=!0,e.once("destroyed",n),t.once("destroyed",n),o.once("complete",r),o.once("error",r))},ir()(xt,sr.a),xt.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},ce.plugin(function(e){e.adapter("idb",He,!0)}).plugin(function(e){e.adapter("http",Ze,!1),e.adapter("https",Ze,!1)}).plugin(Zn).plugin(function(e){e.replicate=Ot,e.sync=jt,Object.defineProperty(e.prototype,"replicate",{get:function(){var r=this;return void 0===this.replicateMethods&&(this.replicateMethods={from:function(e,t,n){return r.constructor.replicate(e,r,t,n)},to:function(e,t,n){return r.constructor.replicate(r,e,t,n)}}),this.replicateMethods}}),e.prototype.sync=function(e,t,n){return this.constructor.sync(this,e,t,n)}}),cr.default=ce}.call(this,ar(282))}}]);